/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
(function(a,b){if(typeof exports==="object"&&exports){b(exports)}else{var c={};b(c);if(typeof define==="function"&&define.amd){define(c)}else{a.Mustache=c}}}(this,function(a){var e=/\s*/;var l=/\s+/;var j=/\S/;var h=/\s*=/;var n=/\s*\}/;var t=/#|\^|\/|>|\{|&|=|!/;var f=RegExp.prototype.test;function s(z,y){return f.call(z,y)}function g(y){return !s(j,y)}var v=Object.prototype.toString;var k=Array.isArray||function(y){return v.call(y)==="[object Array]"};function d(y){return y.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function m(y){return String(y).replace(/[&<>"'\/]/g,function(z){return c[z]})}function u(y){this.string=y;this.tail=y;this.pos=0}u.prototype.eos=function(){return this.tail===""};u.prototype.scan=function(z){var y=this.tail.match(z);if(y&&y.index===0){this.tail=this.tail.substring(y[0].length);this.pos+=y[0].length;return y[0]}return""};u.prototype.scanUntil=function(z){var y,A=this.tail.search(z);switch(A){case -1:y=this.tail;this.pos+=this.tail.length;this.tail="";break;case 0:y="";break;default:y=this.tail.substring(0,A);this.tail=this.tail.substring(A);this.pos+=A}return y};function r(y,z){this.view=y||{};this.parent=z;this._cache={}}r.make=function(y){return(y instanceof r)?y:new r(y)};r.prototype.push=function(y){return new r(y,this)};r.prototype.lookup=function(y){var B=this._cache[y];if(!B){if(y=="."){B=this.view}else{var A=this;while(A){if(y.indexOf(".")>0){B=A.view;var C=y.split("."),z=0;while(B&&z<C.length){B=B[C[z++]]}}else{B=A.view[y]}if(B!=null){break}A=A.parent}}this._cache[y]=B}if(typeof B==="function"){B=B.call(this.view)}return B};function p(){this.clearCache()}p.prototype.clearCache=function(){this._cache={};this._partialCache={}};p.prototype.compile=function(A,y){var z=this._cache[A];if(!z){var B=a.parse(A,y);z=this._cache[A]=this.compileTokens(B,A)}return z};p.prototype.compilePartial=function(z,B,y){var A=this.compile(B,y);this._partialCache[z]=A;return A};p.prototype.getPartial=function(y){if(!(y in this._partialCache)&&this._loadPartial){this.compilePartial(y,this._loadPartial(y))}return this._partialCache[y]};p.prototype.compileTokens=function(A,z){var y=this;return function(B,D){if(D){if(typeof D==="function"){y._loadPartial=D}else{for(var C in D){y.compilePartial(C,D[C])}}}return o(A,y,r.make(B),z)}};p.prototype.render=function(A,y,z){return this.compile(A)(y,z)};function o(F,z,y,I){var C="";var A,G,H;for(var D=0,E=F.length;D<E;++D){A=F[D];G=A[1];switch(A[0]){case"#":H=y.lookup(G);if(typeof H==="object"){if(k(H)){for(var B=0,K=H.length;B<K;++B){C+=o(A[4],z,y.push(H[B]),I)}}else{if(H){C+=o(A[4],z,y.push(H),I)}}}else{if(typeof H==="function"){var J=I==null?null:I.slice(A[3],A[5]);H=H.call(y.view,J,function(L){return z.render(L,y)});if(H!=null){C+=H}}else{if(H){C+=o(A[4],z,y,I)}}}break;case"^":H=y.lookup(G);if(!H||(k(H)&&H.length===0)){C+=o(A[4],z,y,I)}break;case">":H=z.getPartial(G);if(typeof H==="function"){C+=H(y)}break;case"&":H=y.lookup(G);if(H!=null){C+=H}break;case"name":H=y.lookup(G);if(H!=null){C+=a.escape(H)}break;case"text":C+=G;break}}return C}function x(E){var z=[];var D=z;var F=[];var B;for(var A=0,y=E.length;A<y;++A){B=E[A];switch(B[0]){case"#":case"^":F.push(B);D.push(B);D=B[4]=[];break;case"/":var C=F.pop();C[5]=B[2];D=F.length>0?F[F.length-1][4]:z;break;default:D.push(B)}}return z}function b(D){var A=[];var C,z;for(var B=0,y=D.length;B<y;++B){C=D[B];if(C){if(C[0]==="text"&&z&&z[0]==="text"){z[1]+=C[1];z[3]=C[3]}else{z=C;A.push(C)}}}return A}function q(y){return[new RegExp(d(y[0])+"\\s*"),new RegExp("\\s*"+d(y[1]))]}function w(O,E){O=O||"";E=E||a.tags;if(typeof E==="string"){E=E.split(l)}if(E.length!==2){throw new Error("Invalid tags: "+E.join(", "))}var I=q(E);var A=new u(O);var G=[];var F=[];var D=[];var P=false;var N=false;function M(){if(P&&!N){while(D.length){delete F[D.pop()]
}}else{D=[]}P=false;N=false}var B,z,H,J,C;while(!A.eos()){B=A.pos;H=A.scanUntil(I[0]);if(H){for(var K=0,L=H.length;K<L;++K){J=H.charAt(K);if(g(J)){D.push(F.length)}else{N=true}F.push(["text",J,B,B+1]);B+=1;if(J=="\n"){M()}}}if(!A.scan(I[0])){break}P=true;z=A.scan(t)||"name";A.scan(e);if(z==="="){H=A.scanUntil(h);A.scan(h);A.scanUntil(I[1])}else{if(z==="{"){H=A.scanUntil(new RegExp("\\s*"+d("}"+E[1])));A.scan(n);A.scanUntil(I[1]);z="&"}else{H=A.scanUntil(I[1])}}if(!A.scan(I[1])){throw new Error("Unclosed tag at "+A.pos)}C=[z,H,B,A.pos];F.push(C);if(z==="#"||z==="^"){G.push(C)}else{if(z==="/"){if(G.length===0){throw new Error('Unopened section "'+H+'" at '+B)}var y=G.pop();if(y[1]!==H){throw new Error('Unclosed section "'+y[1]+'" at '+B)}}else{if(z==="name"||z==="{"||z==="&"){N=true}else{if(z==="="){E=H.split(l);if(E.length!==2){throw new Error("Invalid tags at "+B+": "+E.join(", "))}I=q(E)}}}}}var y=G.pop();if(y){throw new Error('Unclosed section "'+y[1]+'" at '+A.pos)}F=b(F);return x(F)}a.name="mustache.js";a.version="0.7.2";a.tags=["{{","}}"];a.Scanner=u;a.Context=r;a.Writer=p;a.parse=w;a.escape=m;var i=new p();a.clearCache=function(){return i.clearCache()};a.compile=function(z,y){return i.compile(z,y)};a.compilePartial=function(z,A,y){return i.compilePartial(z,A,y)};a.compileTokens=function(z,y){return i.compileTokens(z,y)};a.render=function(A,y,z){return i.render(A,y,z)};a.to_html=function(B,z,A,C){var y=a.render(B,z,A);if(typeof C==="function"){C(y)}else{return y}}}));function mod_helper(x){var M=x;function z(e,b){if(b===undefined){b=false}if(e===null||typeof(e)!=="object"){return e}if(Array.isArray(e)){var a=[];for(var d=0;d<e.length;d++){if(b===true){a.push(e[d])}else{a.push(z(e[d]))}}return a}var a={};for(var c in e){if(b===true){a[c]=e[c]}else{a[c]=z(e[c])}}return a}function K(c,a){if(typeof(c)!=="object"){return c}if(c===null||Array.isArray(c)){return null}for(var b=0;b<a.length;b++){if(a[b] in c){return c[a[b]]}}return null}function H(d,e){var b={};for(var c=0;c<d.length;c++){var a=K(d[c],e);if(a===null){continue}else{b[a]=c}}return b}function A(b,e,o,m){if(e===null||e===undefined){return z(b)}if(b===null||typeof(b)!=="object"){return e}if(typeof(e)!=="object"){return e}if((Array.isArray(e)&&!(Array.isArray(b)))||(!(Array.isArray(e))&&Array.isArray(b))){return e}if(b===e){return e}var l=z(e);if(o===undefined){o=["definition_key","name"]}if(m===undefined){m=["modification_log","last_healed","denormalized"]}if(Array.isArray(l)){var d=H(l,o);var j=0;for(var a=0;a<b.length;a++){if(typeof(b[a])!=="object"){if(l.indexOf(b[a])===-1){l.push(b[a])}}else{if(Array.isArray(b[a])&&b[a]!==null){j++}else{if(b[a]!==null){var n=K(b[a],o);if(n in d){l[d[n]]=A(b[a],l[d[n]],o)}else{l.push(z(b[a]))}}}}}var k=new Array(b.length-j);var g=[];var h=H(b,o);for(var c=0;c<l.length;c++){var n=K(l[c],o);if(n===null||!(n in h)){g.push(l[c])}else{k[h[n]]=l[c]}}for(var c=0;c<g.length;c++){k.push(g[c])}return k}for(var f in b){if(m.indexOf(f)!==-1){continue}else{if(!(f in e)){complete_property=z(b[f]);l[f]=complete_property}else{l[f]=A(b[f],l[f],o)}}}return l}function J(b){if(!(Array.isArray(b))){return b}var a=[];for(var d=0;d<b.length;d++){var c=b[d];if(c!==null&&c!==undefined){a.push(c)}}return a}function P(c,a){var b=null;if(typeof(c)!=="object"||c===null||Array.isArray(c)){b={}}else{b=z(c,true)}if(typeof(a)==="object"&&a!==null&&!(Array.isArray(a))){for(var d in a){b[d]=a[d]}}return b}function E(a,b){if(typeof(a)!=="object"||a===null||Array.isArray(a)){return null}return a[b]}function F(a,b){if(b in a){delete a[b]}if(b in a){logger.log("could not remove "+b)}}function O(d,f,b){if(b===undefined){b=["definition_key","name"]}var c=[];if(Array.isArray(f)){for(var e=0;e<f.length;e++){if(f[e]===d){continue}if(typeof(f[e])==="object"&&f[e]!==null){var a=K(f[e],b);if(a===d){continue}}c.push(f[e])}}return c}function G(a){var b=[];for(var c in a){b.push(a[c])}return b}function i(a){if(a===null||a===undefined){return true}if(a.length&&a.length>0){return false}if(a.length===0){return true}if(typeof(a)==="number"){return false}if(typeof(a)!=="object"){return true}if(Object.getOwnPropertyNames(a).length>0){return false}return true}function y(a){return/^\w*$/.test(a)}function R(a){var b={};return a&&b.toString.call(a)==="[object Function]"}function I(){var a=new Date().getTime();var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var d=(a+Math.random()*16)%16|0;a=Math.floor(a/16);return(c=="x"?d:(d&7|8)).toString(16)});return b}function B(){function a(){try{throw Error("")}catch(c){return c}}function b(){var c=a();var d=c.stack.split("\n").slice(8);return d}return b()}var L={clone:z,merge:P,compact:J,extend:A,get_values:G,get_property:E,remove_property:F,get_purged_list:O,is_empty:i,contains_only_ascii_words:y,is_function:R,get_uuid:I,stacktrace:B};var N={};var C=Object.keys(L);for(var D=0;D<C.length;D++){var Q=L[C[D]];if(typeof(M)==="object"&&M!==null){N[C[D]]=M.profile(Q)}else{N[C[D]]=Q}}return N}function mod_profiler(){var i={};var n=0;var o=null;function k(a){var b=a.toString();b=b.substr("function ".length);b=b.substr(0,b.indexOf("("));return b}function l(a,b){var c=i[a];if(c===undefined){c={calls:0,elapsed_time:0};i[a]=c}c.calls+=1;c.elapsed_time+=b;if(o===a){n+=b}}function p(a){function b(){var f=k(a);if(o===null){o=f}var c=new Date().getTime();var e=a.apply(undefined,arguments);var d=new Date().getTime()-c;l(f,d);if(o===f){o=null}return e}return b}function j(){return i}function m(){function e(q){var v="";
for(var u=0;u<q;u++){v+=" "}return v}var b=Object.keys(i);var h=b.sort(function(v,u){var q=i[v].elapsed_time;var w=i[u].elapsed_time;if(q<w){return 1}if(q>w){return -1}return 0});var g=0;for(var a=0;a<h.length;a++){if(h[a].length>g){g=h[a].length}}var d="\n"+e(g)+" #calls\telapsed\t% of total\n";for(var a=0;a<h.length;a++){if(n===0){break}var f=h[a];var c=i[f].elapsed_time*100/n;if(c<0.3){break}d+=f+":"+e(g-1-f.length)+i[f].calls+"\t"+i[f].elapsed_time+"\t"+c.toFixed(2)+"\n"}d+="==========\n";d+="total time accounted for [ms]: "+n;return d}return{profile:p,get_profiles_by_function_name:j,get_formatted_result:m}};var LOG_LEVEL={message:0,warning:1,error:2};function mod_logger(H,w,s){var E=H;var x=w;var z=s;var F=mod_helper();var i=null;var C=null;if(!(Array.isArray(E.design_elements))){E.design_elements=[]}for(var A=0;A<E.design_elements.length;A++){if(typeof(E.design_elements[A])!=="object"||E.design_elements[A]===null||Array.isArray(E.design_elements[A])){continue}if(E.design_elements[A].name==="log_level"){i=E.design_elements.splice(A,1)[0];break}}E.definition_type="Log";E.title_multilanguage_key="&&mlkey_log_definition";var G={name:"log_level",label:"log level",value:1,value_type:"number",element_type:"Number",user_enabled_setting:1};var v={name:"log_application_context",label:"log application context",value:"",value_type:"key",element_type:"ApplicationChoice",user_enabled_setting:1};var y={name:"log_current_action",label:"log current action",value:"",value_type:"unicode",element_type:"Text",user_enabled_setting:1};if(i===null){i=F.clone(G)}else{i=F.extend(G,i)}C=F.clone(v);if(typeof(x.application_key)==="string"){C.value=x.application_key}log_action_schema_field=F.clone(y);if(typeof(x.action)==="string"){log_action_schema_field.value=x.action}E.design_elements.unshift(i);E.design_elements.unshift(C);E.design_elements.unshift(log_action_schema_field);var t=D();var u={name:t,label:t,value:"",value_type:"unicode",element_type:"Text",grid_size_setting:1,user_enabled_setting:1};E.design_elements.push(u);function D(){return(new Date()).toISOString()}function B(b,a){if(a===undefined){a=LOG_LEVEL.warning}if(a>i.value){i.value=a}if(u.value.length>0){u.value+="\n"}if(a>LOG_LEVEL.message){u.value+=D()+"; log level: "+a+"; "+b+"; function trace: "+F.stacktrace()}else{u.value+=D()+"; log level: "+a+"; "+b}return}return{log_card:E,get_utc_now:D,log:B}};var STRUCTURE_VERSION="2015-03-02T01:34:43";var ML_KEYS={name_key:"&&mlkey_card_name",title_key:"&&mlkey_card_title",plural_name:"&&mlkey_card_plural_name",comment:"&&mlkey_card_comment",label_key:"&&mlkey_card_label",help_text:"&&mlkey_card_help_text",optional:"&&mlkey_card_optional",mandatory:"&&mlkey_card_mandatory",requirement_setting:"&&mlkey_card_requirement_setting",user_enabled_setting:"&&mlkey_card_user_enabled_setting",editable:"&&mlkey_card_editable",script_library:"&&mlkey_script_library",menu_definitions:"&&mlkey_menu_definitions",before_first_save:"&&mlkey_card_before_first_save",computed:"&&mlkey_card_computed",default_card:"&&mlkey_default_card",description_key:"&&mlkey_description",create_application_label:"&&mlkey_create_application_label",delete_modal_title:"&&mlkey_delete_modal_title",delete_modal_description:"&&mlkey_delete_modal_description",discard_changes_modal_title:"&&mlkey_discard_changes_modal_title",discard_changes_modal_description:"&&mlkey_discard_changes_modal_description",ok_label:"&&mlkey_ok_label",cancel_label:"&&mlkey_cancel_label",confirm_label:"&&mlkey_confirm_label",open_label:"&&mlkey_open_label",definition_key:"&&mlkey_definition_key",proto_definition_key:"&&mlkey_proto_definition_key",application_properties_key:"&&mlkey_application_properties_key",field_definition_key:"&&mlkey_field_definition_key",save_label:"&&mlkey_field_save_label",save_and_close_label:"&&mlkey_save_and_close_label",close_without_saving_label:"&&mlkey_close_without_saving_label",address_only_ascii_error:"&&mlkey_address_only_ascii_error",inline_edit_group_label:"&&mlkey_inline_edit_group_label",inline_edit_change_meaning:"&&mlkey_inline_edit_change_meaning",inline_edit_new_meaning:"&&mlkey_inline_edit_new_meaning",save_changes_modal_title:"&&mlkey_save_changes_modal_title",save_changes_modal_description:"&&mlkey_save_changes_modal_description",do_not_save_label:"&&mlkey_do_not_save_label",design_elements:"&&mlkey_design_elements",use_as_address_setting:"&&mlkey_use_as_address_setting",parent_application_setting:"&&mlkey_parent_application_setting",parent_entity_proto_setting:"&&mlkey_parent_entity_proto_setting",cardinality_setting:"&&mlkey_cardinality_setting",one_to_one:"&&mlkey_one_to_one",many_to_one:"&&mlkey_many_to_one",one_to_many:"&&mlkey_one_to_many",automatically_embed_on_parent:"&&mlkey_automatically_embed_on_parent",display_priority_setting:"&&mlkey_display_priority_setting",empty_value:"&&mlkey_empty_value",inline_edit_related:"&&mlkey_inline_edit_related",inline_edit_clear:"&&mlkey_inline_edit_clear",text_field_definition_key:"&&mlkey_text_field_definition_key",relation_field_definition_key:"&&mlkey_relation_field_definition_key",datetime_field_definition_key:"&&mlkey_datetime_field_definition_key",create_new_definition_title:"&&mlkey_create_new_definition_title",add_card_title:"&&mlkey_add_card_title",create_label:"&&mlkey_create_label",add_label:"&&mlkey_add_label",menu_definition_key:"&&mlkey_menu_definition_key",menu_entries:"&&mlkey_menu_entries",tableview_definition_key:"&&mlkey_tableview_definition_key",create_card_modal_description:"&&mlkey_create_card_modal_description",add_card_modal_description:"&&mlkey_add_card_modal_description",save_first_hint:"&&mlkey_save_first_hint",show_keys_setting:"&&mlkey_show_keys_setting",show_short_name_setting:"&&mlkey_show_short_name_setting",show_modified_setting:"&&mlkey_show_modified_setting",show_modifier_setting:"&&mlkey_show_modifier_setting",show_created_setting:"&&mlkey_show_created_setting",show_creator_setting:"&&mlkey_show_creator_setting",modified:"&&mlkey_modified",created:"&&mlkey_created",modifier:"&&mlkey_modifier",creator:"&&mlkey_creator",languages:"&&mlkey_languages",language:"&&mlkey_language",application_language_choice_dialog_title:"&&mlkey_application_language_choice_dialog_title",application_language_choice_dialog_description:"&&mlkey_application_language_choice_dialog_description",locale:"&&mlkey_locale",user_definition_key:"&&mlkey_user_definition_key",first_name:"&&mlkey_first_name",last_name:"&&mlkey_last_name",email:"&&mlkey_email",password:"&&mlkey_password",password_again:"&&mlkey_password_again",script_library_definition_key:"&&mlkey_script_library_definition_key",code_key:"&&mlkey_code_key",new_tableview_key:"&&mlkey_new_tableview_key",before_first_save_card_save_prefix:"&&mlkey_first_save_card_save_prefix",grid_size_setting:"&&mlkey_grid_size_setting",one_column:"&&mlkey_one_column",entire_row:"&&mlkey_entire_row",number_field_definition_key:"&&mlkey_number_field_definition_key",log_definition:"&&mlkey_log_definition",design_menu_header:"&&mlkey_design_menu_header",admin_menu_header:"&&mlkey_admin_menu_header",protos_tableview_title:"&&mlkey_protos_tableview_title",all_tableview_title:"&&mlkey_all_tableview_title",multilanguage_tableview_title:"&&mlkey_multilanguage_tableview_title",scriptlibrary_tableview_title:"&&mlkey_scriptlibrary_tableview_title",log_tableview_title:"&&mlkey_log_tableview_title",design_from_template:"&&mlkey_design_from_template",users_tableview_title:"&&mlkey_users_tableview_title",error_definition:"&&mlkey_error_definition",login_definition_key:"&&mlkey_login_definition_key",email_or_userid:"&&mlkey_email_or_userid",automatically_created_tableview_proto:"&&mlkey_automatically_created_tableview_proto",menu_title_key:"&&mlkey_menu_title_key",application_properties_name_help_text:"&&mlkey_application_properties_name_help_text",application_properties_title_help_text:"&&mlkey_application_properties_title_help_text",application_properties_description_help_text:"&&mlkey_application_properties_description_help_text",application_properties_default_card_help_text:"&&mlkey_application_properties_default_card_help_text",application_properties_languages_help_text:"&&mlkey_application_properties_languages_help_text",application_properties_template_help_text:"&&mlkey_application_properties_template_help_text",application_properties_menus_help_text:"&&mlkey_application_properties_menus_help_text",users_app_title:"&&mlkey_users_app_title",users_app_description:"&&mlkey_users_app_description",number_of_lines_setting:"&&mlkey_number_of_lines_setting",single_line:"&&mlkey_single_line",multi_line:"&&mlkey_multi_line",password_missing:"&&mlkey_password_missing",password_not_identical:"&&mlkey_password_not_identical",password_too_short:"&&mlkey_password_too_short",resource_conflict:"&&mlkey_resource_conflict",is_enviroment_manager:"&&mlkey_is_enviroment_manager",environment_manager_requires_password:"&&mlkey_environment_manager_requires_password",password_only_ascii_error:"&&mlkey_password_only_ascii_error",edit_user_profile_caption:"&&mlkey_edit_user_profile_caption",with_selected_label:"&&mlkey_with_selected_label",put_to_trash_label:"&&mlkey_put_to_trash_label",delete_label:"&&mlkey_delete_label",deleted_label:"&&mlkey_deleted_label",trash_tableview_title:"&&mlkey_trash_tableview_title",main_menu_header:"&&mlkey_main_menu_header",restore_label:"&&mlkey_restore_label",card_menu_label:"&&mlkey_card_menu_label",open_proto:"&&mlkey_open_proto",role_definition_key:"&&mlkey_role_definition_key",role_name:"&&mlkey_role_name",roles_app_title:"&&mlkey_roles_app_title",roles_app_description:"&&mlkey_roles_app_description",roles_tableview_title:"&&mlkey_roles_tableview_title",assigned_roles:"&&mlkey_assigned_roles",allow_new_cards:"&&mlkey_allow_new_cards",url_name_key:"&&mlkey_url_name_key",enable_filtering_for_id:"&&mlkey_enable_filtering_for_id",enable_filtering:"&&mlkey_enable_filtering",cards_based_on_this:"&&mlkey_cards_based_on_this",put_into_menu_prefix:"&&mlkey_put_into_menu_prefix",login_button_label:"&&mlkey_login_button_label",environment_properties_title:"&&mlkey_environment_properties_title",environment_name:"&&mlkey_environment_name",environment_settings_label:"&&mlkey_environment_settings_label",about_protogrid_label:"&&mlkey_about_protogrid_label",issues_label:"&&mlkey_issues_label",remove_from_tableview:"&&mlkey_remove_from_tableview",proto_name_help_text:"&&mlkey_proto_name_help_text",proto_plural_name_help_text:"&&mlkey_proto_plural_name_help_text",proto_script_library_help_text:"&&mlkey_proto_script_library_help_text",proto_enable_filtering_help_text:"&&mlkey_proto_enable_filtering_help_text",proto_automatic_tableview_help_text:"&&mlkey_proto_automatic_tableview_help_text",protos_tableview_label:"&&mlkey_protos_tableview_label",protos_tableview_helptext:"&&mlkey_protos_tableview_helptext",design_element_label_helptext:"&&mlkey_design_element_label_helptext",design_element_helptext_helptext:"&&mlkey_design_element_helptext_helptext",application_setting_helptext:"&&mlkey_application_setting_helptext",proto_setting_helptext:"&&mlkey_proto_setting_helptext",user_enabled_setting_helptext:"&&mlkey_user_enabled_setting_helptext",display_priority_setting_helptext:"&&mlkey_display_priority_setting_helptext",parent_application_setting_helptext:"&&mlkey_parent_application_setting_helptext",parent_entity_proto_setting_helptext:"&&mlkey_parent_entity_proto_setting_helptext",cardinality_setting_helptext:"&&mlkey_cardinality_setting_helptext",allow_new_cards_setting_helptext:"&&mlkey_allow_new_cards_setting_helptext",enable_filtering_helptext:"&&mlkey_enable_filtering_helptext",put_to_element_prefix:"&&mlkey_put_to_element_prefix",put_to_element_postfix:"&&mlkey_put_to_element_postfix",only_show_for_role:"&&mlkey_only_show_for_role",show_cards_to_users:"&&mlkey_show_cards_to_users",all_application_users:"&&mlkey_all_application_users",users_related_to_card_and_editors:"&&mlkey_users_related_to_card_and_editors",only_editors:"&&mlkey_only_editors",editor_role:"&&mlkey_editor_role",editor_role_help_text:"&&mlkey_editor_role_help_text",show_cards_to_users_help_text:"&&mlkey_show_cards_to_users_help_text",full_access_role:"&&mlkey_full_access_role",full_access_role_help_text:"&&mlkey_full_access_role_help_text",user_access_role:"&&mlkey_user_access_role",user_access_role_help_text:"&&mlkey_user_access_role_help_text",system_role:"&&mlkey_system_role",application_creator_role:"&&mlkey_application_creator_role",role_editor_role:"&&mlkey_role_editor_role",creator_role:"&&mlkey_creator_role",creator_role_help_text:"&&mlkey_creator_role_help_text",allow_editing_cards_to_users:"&&mlkey_allow_editing_cards_to_users",allow_editing_cards_to_users_help_text:"&&mlkey_allow_editing_cards_to_users_help_text",edit_access_users_related_to_card_and_editors:"&&mlkey_edit_access_users_related_to_card_and_editors",edit_access_editors_only:"&&mlkey_edit_access_editors_only",environment_administrator:"&&mlkey_environment_administrator",member:"&&mlkey_member",user_relation_field_definition_key:"&&mlkey_user_relation_field_definition_key",show_card_properties:"&&mlkey_show_card_properties",card_properties_title:"&&mlkey_card_properties_title",card_id:"&&mlkey_card_id",app_id:"&&mlkey_app_id",show_in_environment_role:"&&mlkey_show_in_environment_role",show_in_environment_role_help_text:"&&mlkey_show_in_environment_role_help_text",update_action:"&&mlkey_update_action",icon_url:"&&mlkey_icon_url",icon_url_help_text:"&&mlkey_icon_url_help_text",enable_attachments:"&&mlkey_enable_attachments",filename:"&&mlkey_filename",size:"&&mlkey_size",attachments:"&&mlkey_attachments",theme_color:"&&mlkey_theme_color",theme_color_helptext:"&&mlkey_theme_color_helptext",proto_theme_color_helptext:"&&mlkey_proto_theme_color_helptext",card_type:"&&mlkey_card_type",import_action:"&&mlkey_import_action",import_modal_title:"&&mlkey_import_modal_title",import_modal_description:"&&mlkey_import_modal_description",data_proto:"&&mlkey_data_proto",tableview_proto:"&&mlkey_tableview_proto",utility_proto:"&&mlkey_utility_proto",presentation_setting:"&&mlkey_presentation_setting",selection:"&&mlkey_selection",table_existing:"&&mlkey_table_existing",table_new:"&&mlkey_table_new",presentation_setting_helptext:"&&mlkey_presentation_setting_helptext",environment_title:"&&mlkey_environment_title",environment_title_help_text:"&&mlkey_environment_title_help_text",filter_automatically_setting:"&&mlkey_filter_automatically_setting",filter_automatically_setting_helptext:"&&mlkey_filter_automatically_setting_helptext",import_export_title_key:"&&mlkey_import_export_title_key",rollout_ios:"&&mlkey_rollout_ios",ml_definitions_tableview_helptext:"&&mlkey_ml_definitions_tableview_helptext",user_languages_help_text:"&&mlkey_user_languages_help_text",date_format_language:"&&mlkey_date_format_language",date_format_language_helptext:"&&mlkey_date_format_language_helptext",billing_agreement:"&&mlkey_billing_agreement",billing_agreement_content:"&&mlkey_billing_agreement_content",company_name_for_invoice:"&&mlkey_company_name_for_invoice",company_name_for_invoice_help_text:"&&mlkey_company_name_for_invoice_help_text",email_for_invoice:"&&mlkey_email_for_invoice",email_for_invoice_help_text:"&&mlkey_email_for_invoice_help_text",invoice_contact:"&&mlkey_invoice_contact",invoice_contact_help_text:"&&mlkey_invoice_contact_help_text",invoice_department:"&&mlkey_invoice_department",invoice_department_help_text:"&&mlkey_invoice_department_help_text",invoice_address:"&&mlkey_invoice_address",invoice_address_help_text:"&&mlkey_invoice_address_help_text",invoice_zipcode:"&&mlkey_invoice_zipcode",invoice_zipcode_help_text:"&&mlkey_invoice_zipcode_help_text",invoice_city:"&&mlkey_invoice_city",invoice_city_help_text:"&&mlkey_invoice_city_help_text",invoice_country:"&&mlkey_invoice_country",invoice_country_help_text:"&&mlkey_invoice_country_help_text",administrative_contact_email:"&&mlkey_administrative_contact_email",administrative_contact_email_help_text:"&&mlkey_administrative_contact_email_help_text",technical_contact_email:"&&mlkey_technical_contact_email",technical_contact_email_help_text:"&&mlkey_technical_contact_email_help_text",hereby_agree:"&&mlkey_hereby_agree",upgrade_label:"&&mlkey_upgrade_label",additional_contact_section:"&&mlkey_additional_contact_section",agreement_section:"&&mlkey_agreement_section",currency_for_invoice:"&&mlkey_currency_for_invoice",mandatory_on_agree:"&&mlkey_mandatory_on_agree",invoice_amount_content_1:"&&mlkey_invoice_amount_content_1",invoice_amount_content_2:"&&mlkey_invoice_amount_content_2",invoice_amount:"&&mlkey_invoice_amount",billing_agreement_required:"&&mlkey_billing_agreement_required",billing_agreement_explanation:"&&mlkey_billing_agreement_explanation",yes:"&&mlkey_yes",no:"&&mlkey_no",datetime_display_setting:"&&mlkey_datetime_display_setting",datetime:"&&mlkey_datetime",date_only:"&&mlkey_date_only",datetime_display_setting_helptext:"&&mlkey_datetime_display_setting_helptext"};
var INTERFACE_LANGUAGES={en:null};var LANGUAGE_BY_LOCALE={af_NA:"Afrikaans (Namibia) *",af_ZA:"Afrikaans (South Africa) *",af:"Afrikaans *",ak_GH:"Akan (Ghana) *",ak:"Akan *",sq_AL:"Albanian (Albania) *",sq:"Albanian *",am_ET:"Amharic (Ethiopia) *",am:"Amharic *",ar_DZ:"Arabic (Algeria) *",ar_BH:"Arabic (Bahrain) *",ar_EG:"Arabic (Egypt) *",ar_IQ:"Arabic (Iraq) *",ar_JO:"Arabic (Jordan) *",ar_KW:"Arabic (Kuwait) *",ar_LB:"Arabic (Lebanon) *",ar_LY:"Arabic (Libya) *",ar_MA:"Arabic (Morocco) *",ar_OM:"Arabic (Oman) *",ar_QA:"Arabic (Qatar) *",ar_SA:"Arabic (Saudi Arabia) *",ar_SD:"Arabic (Sudan) *",ar_SY:"Arabic (Syria) *",ar_TN:"Arabic (Tunisia) *",ar_AE:"Arabic (United Arab Emirates) *",ar_YE:"Arabic (Yemen) *",ar:"Arabic *",hy_AM:"Armenian (Armenia) *",hy:"Armenian *",as_IN:"Assamese (India) *",as:"Assamese *",asa_TZ:"Asu (Tanzania) *",asa:"Asu *",az_Cyrl:"Azerbaijani (Cyrillic) *",az_Cyrl_AZ:"Azerbaijani (Cyrillic, Azerbaijan) *",az_Latn:"Azerbaijani (Latin) *",az_Latn_AZ:"Azerbaijani (Latin, Azerbaijan) *",az:"Azerbaijani *",bm_ML:"Bambara (Mali) *",bm:"Bambara *",eu_ES:"Basque (Spain) *",eu:"Basque *",be_BY:"Belarusian (Belarus) *",be:"Belarusian *",bem_ZM:"Bemba (Zambia) *",bem:"Bemba *",bez_TZ:"Bena (Tanzania) *",bez:"Bena *",bn_BD:"Bengali (Bangladesh) *",bn_IN:"Bengali (India) *",bn:"Bengali *",bs_BA:"Bosnian (Bosnia and Herzegovina) *",bs:"Bosnian *",bg_BG:"Bulgarian (Bulgaria) *",bg:"Bulgarian *",my_MM:"Burmese (Myanmar [Burma]) *",my:"Burmese *",ca_ES:"Catalan (Spain) *",ca:"Catalan *",tzm_Latn:"Central Morocco Tamazight (Latin) *",tzm_Latn_MA:"Central Morocco Tamazight (Latin, Morocco) *",tzm:"Central Morocco Tamazight *",chr_US:"Cherokee (United States) *",chr:"Cherokee *",cgg_UG:"Chiga (Uganda) *",cgg:"Chiga *",zh_Hans:"Chinese (Simplified Han) *",zh_Hans_CN:"Chinese (Simplified Han, China) *",zh_Hans_HK:"Chinese (Simplified Han, Hong Kong SAR China) *",zh_Hans_MO:"Chinese (Simplified Han, Macau SAR China) *",zh_Hans_SG:"Chinese (Simplified Han, Singapore) *",zh_Hant:"Chinese (Traditional Han) *",zh_Hant_HK:"Chinese (Traditional Han, Hong Kong SAR China) *",zh_Hant_MO:"Chinese (Traditional Han, Macau SAR China) *",zh_Hant_TW:"Chinese (Traditional Han, Taiwan) *",zh:"Chinese *",kw_GB:"Cornish (United Kingdom) *",kw:"Cornish *",hr_HR:"Croatian (Croatia) *",hr:"Croatian *",cs_CZ:"Czech (Czech Republic) *",cs:"Czech *",da_DK:"Danish (Denmark) *",da:"Danish *",nl_BE:"Dutch (Belgium) *",nl_NL:"Dutch (Netherlands) *",nl:"Dutch *",ebu_KE:"Embu (Kenya) *",ebu:"Embu *",en_AS:"English (American Samoa) *",en_AU:"English (Australia) *",en_BE:"English (Belgium) *",en_BZ:"English (Belize) *",en_BW:"English (Botswana) *",en_CA:"English (Canada) *",en_GU:"English (Guam) *",en_HK:"English (Hong Kong SAR China) *",en_IN:"English (India) *",en_IE:"English (Ireland) *",en_JM:"English (Jamaica) *",en_MT:"English (Malta) *",en_MH:"English (Marshall Islands) *",en_MU:"English (Mauritius) *",en_NA:"English (Namibia) *",en_NZ:"English (New Zealand) *",en_MP:"English (Northern Mariana Islands) *",en_PK:"English (Pakistan) *",en_PH:"English (Philippines) *",en_SG:"English (Singapore) *",en_ZA:"English (South Africa) *",en_TT:"English (Trinidad and Tobago) *",en_UM:"English (U.S. Minor Outlying Islands) *",en_VI:"English (U.S. Virgin Islands) *",en_GB:"English (United Kingdom) *",en_US:"English (United States)",en_ZW:"English (Zimbabwe) *",en:"English",eo:"Esperanto *",et_EE:"Estonian (Estonia) *",et:"Estonian *",ee_GH:"Ewe (Ghana) *",ee_TG:"Ewe (Togo) *",ee:"Ewe *",fo_FO:"Faroese (Faroe Islands) *",fo:"Faroese *",fil_PH:"Filipino (Philippines) *",fil:"Filipino *",fi_FI:"Finnish (Finland) *",fi:"Finnish *",fr_BE:"French (Belgium) *",fr_BJ:"French (Benin) *",fr_BF:"French (Burkina Faso) *",fr_BI:"French (Burundi) *",fr_CM:"French (Cameroon) *",fr_CA:"French (Canada) *",fr_CF:"French (Central African Republic) *",fr_TD:"French (Chad) *",fr_KM:"French (Comoros) *",fr_CG:"French (Congo - Brazzaville) *",fr_CD:"French (Congo - Kinshasa) *",fr_CI:"French (Côte d’Ivoire) *",fr_DJ:"French (Djibouti) *",fr_GQ:"French (Equatorial Guinea) *",fr_FR:"French (France) *",fr_GA:"French (Gabon) *",fr_GP:"French (Guadeloupe) *",fr_GN:"French (Guinea) *",fr_LU:"French (Luxembourg) *",fr_MG:"French (Madagascar) *",fr_ML:"French (Mali) *",fr_MQ:"French (Martinique) *",fr_MC:"French (Monaco) *",fr_NE:"French (Niger) *",fr_RW:"French (Rwanda) *",fr_RE:"French (Réunion) *",fr_BL:"French (Saint Barthélemy) *",fr_MF:"French (Saint Martin) *",fr_SN:"French (Senegal) *",fr_CH:"French (Switzerland) *",fr_TG:"French (Togo) *",fr:"French *",ff_SN:"Fulah (Senegal) *",ff:"Fulah *",gl_ES:"Galician (Spain) *",gl:"Galician *",lg_UG:"Ganda (Uganda) *",lg:"Ganda *",ka_GE:"Georgian (Georgia) *",ka:"Georgian *",de_AT:"German (Austria) *",de_BE:"German (Belgium) *",de_DE:"German (Germany)",de_LI:"German (Liechtenstein) *",de_LU:"German (Luxembourg) *",de_CH:"German (Switzerland) *",de:"German",el_CY:"Greek (Cyprus) *",el_GR:"Greek (Greece) *",el:"Greek *",gu_IN:"Gujarati (India) *",gu:"Gujarati *",guz_KE:"Gusii (Kenya) *",guz:"Gusii *",ha_Latn:"Hausa (Latin) *",ha_Latn_GH:"Hausa (Latin, Ghana) *",ha_Latn_NE:"Hausa (Latin, Niger) *",ha_Latn_NG:"Hausa (Latin, Nigeria) *",ha:"Hausa *",haw_US:"Hawaiian (United States) *",haw:"Hawaiian *",he_IL:"Hebrew (Israel) *",he:"Hebrew *",hi_IN:"Hindi (India) *",hi:"Hindi *",hu_HU:"Hungarian (Hungary) *",hu:"Hungarian *",is_IS:"Icelandic (Iceland) *",is:"Icelandic *",ig_NG:"Igbo (Nigeria) *",ig:"Igbo *",id_ID:"Indonesian (Indonesia) *",id:"Indonesian *",ga_IE:"Irish (Ireland) *",ga:"Irish *",it_IT:"Italian (Italy) *",it_CH:"Italian (Switzerland) *",it:"Italian *",ja_JP:"Japanese (Japan) *",ja:"Japanese *",kea_CV:"Kabuverdianu (Cape Verde) *",kea:"Kabuverdianu *",kab_DZ:"Kabyle (Algeria) *",kab:"Kabyle *",kl_GL:"Kalaallisut (Greenland) *",kl:"Kalaallisut *",kln_KE:"Kalenjin (Kenya) *",kln:"Kalenjin *",kam_KE:"Kamba (Kenya) *",kam:"Kamba *",kn_IN:"Kannada (India) *",kn:"Kannada *",kk_Cyrl:"Kazakh (Cyrillic) *",kk_Cyrl_KZ:"Kazakh (Cyrillic, Kazakhstan) *",kk:"Kazakh *",km_KH:"Khmer (Cambodia) *",km:"Khmer *",ki_KE:"Kikuyu (Kenya) *",ki:"Kikuyu *",rw_RW:"Kinyarwanda (Rwanda) *",rw:"Kinyarwanda *",kok_IN:"Konkani (India) *",kok:"Konkani *",ko_KR:"Korean (South Korea) *",ko:"Korean *",khq_ML:"Koyra Chiini (Mali) *",khq:"Koyra Chiini *",ses_ML:"Koyraboro Senni (Mali) *",ses:"Koyraboro Senni *",lag_TZ:"Langi (Tanzania) *",lag:"Langi *",lv_LV:"Latvian (Latvia) *",lv:"Latvian *",lt_LT:"Lithuanian (Lithuania) *",lt:"Lithuanian *",luo_KE:"Luo (Kenya) *",luo:"Luo *",luy_KE:"Luyia (Kenya) *",luy:"Luyia *",mk_MK:"Macedonian (Macedonia) *",mk:"Macedonian *",jmc_TZ:"Machame (Tanzania) *",jmc:"Machame *",kde_TZ:"Makonde (Tanzania) *",kde:"Makonde *",mg_MG:"Malagasy (Madagascar) *",mg:"Malagasy *",ms_BN:"Malay (Brunei) *",ms_MY:"Malay (Malaysia) *",ms:"Malay *",ml_IN:"Malayalam (India) *",ml:"Malayalam *",mt_MT:"Maltese (Malta) *",mt:"Maltese *",gv_GB:"Manx (United Kingdom) *",gv:"Manx *",mr_IN:"Marathi (India) *",mr:"Marathi *",mas_KE:"Masai (Kenya) *",mas_TZ:"Masai (Tanzania) *",mas:"Masai *",mer_KE:"Meru (Kenya) *",mer:"Meru *",mfe_MU:"Morisyen (Mauritius) *",mfe:"Morisyen *",naq_NA:"Nama (Namibia) *",naq:"Nama *",ne_IN:"Nepali (India) *",ne_NP:"Nepali (Nepal) *",ne:"Nepali *",nd_ZW:"North Ndebele (Zimbabwe) *",nd:"North Ndebele *",nb_NO:"Norwegian Bokmål (Norway) *",nb:"Norwegian Bokmål *",nn_NO:"Norwegian Nynorsk (Norway) *",nn:"Norwegian Nynorsk *",nyn_UG:"Nyankole (Uganda) *",nyn:"Nyankole *",or_IN:"Oriya (India) *",or:"Oriya *",om_ET:"Oromo (Ethiopia) *",m_KE:"Oromo (Kenya) *",om:"Oromo *",ps_AF:"Pashto (Afghanistan) *",ps:"Pashto *",fa_AF:"Persian (Afghanistan) *",fa_IR:"Persian (Iran) *",fa:"Persian *",pl_PL:"Polish (Poland) *",pl:"Polish *",pt_BR:"Portuguese (Brazil) *",pt_GW:"Portuguese (Guinea-Bissau) *",pt_MZ:"Portuguese (Mozambique) *",pt_PT:"Portuguese (Portugal) *",pt:"Portuguese *",pa_Arab:"Punjabi (Arabic) *",pa_Arab_PK:"Punjabi (Arabic, Pakistan) *",pa_Guru:"Punjabi (Gurmukhi) *",pa_Guru_IN:"Punjabi (Gurmukhi, India) *",pa:"Punjabi *",ro_MD:"Romanian (Moldova) *",ro_RO:"Romanian (Romania) *",ro:"Romanian *",rm_CH:"Romansh (Switzerland) *",rm:"Romansh *",rof_TZ:"Rombo (Tanzania) *",rof:"Rombo *",ru_MD:"Russian (Moldova) *",ru_RU:"Russian (Russia) *",ru_UA:"Russian (Ukraine) *",ru:"Russian *",rwk_TZ:"Rwa (Tanzania) *",rwk:"Rwa *",saq_KE:"Samburu (Kenya) *",saq:"Samburu *",sg_CF:"Sango (Central African Republic) *",sg:"Sango *",seh_MZ:"Sena (Mozambique) *",seh:"Sena *",sr_Cyrl:"Serbian (Cyrillic) *",sr_Cyrl_BA:"Serbian (Cyrillic, Bosnia and Herzegovina) *",sr_Cyrl_ME:"Serbian (Cyrillic, Montenegro) *",sr_Cyrl_RS:"Serbian (Cyrillic, Serbia) *",sr_Latn:"Serbian (Latin) *",sr_Latn_BA:"Serbian (Latin, Bosnia and Herzegovina) *",sr_Latn_ME:"Serbian (Latin, Montenegro) *",sr_Latn_RS:"Serbian (Latin, Serbia) *",sr:"Serbian *",sn_ZW:"Shona (Zimbabwe) *",sn:"Shona *",ii_CN:"Sichuan Yi (China) *",ii:"Sichuan Yi *",si_LK:"Sinhala (Sri Lanka) *",si:"Sinhala *",sk_SK:"Slovak (Slovakia) *",sk:"Slovak *",sl_SI:"Slovenian (Slovenia) *",sl:"Slovenian *",xog_UG:"Soga (Uganda) *",xog:"Soga *",so_DJ:"Somali (Djibouti) *",so_ET:"Somali (Ethiopia) *",so_KE:"Somali (Kenya) *",so_SO:"Somali (Somalia) *",so:"Somali *",es_AR:"Spanish (Argentina) *",es_BO:"Spanish (Bolivia) *",es_CL:"Spanish (Chile) *",es_CO:"Spanish (Colombia) *",es_CR:"Spanish (Costa Rica) *",es_DO:"Spanish (Dominican Republic) *",es_EC:"Spanish (Ecuador) *",es_SV:"Spanish (El Salvador) *",es_GQ:"Spanish (Equatorial Guinea) *",es_GT:"Spanish (Guatemala) *",es_HN:"Spanish (Honduras) *",es_419:"Spanish (Latin America) *",es_MX:"Spanish (Mexico) *",es_NI:"Spanish (Nicaragua) *",es_PA:"Spanish (Panama) *",es_PY:"Spanish (Paraguay) *",es_PE:"Spanish (Peru) *",es_PR:"Spanish (Puerto Rico) *",es_ES:"Spanish (Spain)",es_US:"Spanish (United States) *",es_UY:"Spanish (Uruguay) *",es_VE:"Spanish (Venezuela) *",es:"Spanish",sw_KE:"Swahili (Kenya) *",sw_TZ:"Swahili (Tanzania) *",sw:"Swahili *",sv_FI:"Swedish (Finland) *",sv_SE:"Swedish (Sweden) *",sv:"Swedish *",gsw_CH:"Swiss German (Switzerland) *",gsw:"Swiss German *",shi_Latn:"Tachelhit (Latin) *",shi_Latn_MA:"Tachelhit (Latin, Morocco) *",shi_Tfng:"Tachelhit (Tifinagh) *",shi_Tfng_MA:"Tachelhit (Tifinagh, Morocco) *",shi:"Tachelhit *",dav_KE:"Taita (Kenya) *",dav:"Taita *",ta_IN:"Tamil (India) *",ta_LK:"Tamil (Sri Lanka) *",ta:"Tamil *",te_IN:"Telugu (India) *",te:"Telugu *",teo_KE:"Teso (Kenya) *",teo_UG:"Teso (Uganda) *",teo:"Teso *",th_TH:"Thai (Thailand) *",th:"Thai *",bo_CN:"Tibetan (China) *",bo_IN:"Tibetan (India) *",bo:"Tibetan *",ti_ER:"Tigrinya (Eritrea) *",ti_ET:"Tigrinya (Ethiopia) *",ti:"Tigrinya *",to_TO:"Tonga (Tonga) *",to:"Tonga *",tr_TR:"Turkish (Turkey) *",tr:"Turkish *",uk_UA:"Ukrainian (Ukraine) *",uk:"Ukrainian *",ur_IN:"Urdu (India) *",ur_PK:"Urdu (Pakistan) *",ur:"Urdu *",uz_Arab:"Uzbek (Arabic) *",uz_Arab_AF:"Uzbek (Arabic, Afghanistan) *",uz_Cyrl:"Uzbek (Cyrillic) *",uz_Cyrl_UZ:"Uzbek (Cyrillic, Uzbekistan) *",uz_Latn:"Uzbek (Latin) *",uz_Latn_UZ:"Uzbek (Latin, Uzbekistan) *",uz:"Uzbek *",vi_VN:"Vietnamese (Vietnam) *",vi:"Vietnamese *",vun_TZ:"Vunjo (Tanzania) *",vun:"Vunjo *",cy_GB:"Welsh (United Kingdom) *",cy:"Welsh *",yo_NG:"Yoruba (Nigeria) *",yo:"Yoruba *",zu_ZA:"Zulu (South Africa) *",zu:"Zul *u"};
var SCRIPT_LIBRARY_KEYS={users:"&&slkey_users",environment_properties:"&&slkey_environment_properties"};function mod_design_element_structure(){var S={};var ac={definition_key:""};ac.__proto__=S;var X={name:"",grid_size_setting:0,show_to_users:0,disable_label:false};X.__proto__=S;var Z={value:""};Z.__proto__=ac;var W={element_type:"TableView",label_multilanguage_key:"",hidden:false,grid_size_setting:1,help_text:"",application_setting:"",entity_proto_setting:"",show_keys_setting:false,show_short_name_setting:false,show_modified_setting:true,show_modifier_setting:true,show_created_setting:true,show_creator_setting:true,show_card_type:false,couchdb_viewname:""};W.__proto__=X;var T={element_type:"Button",label_multilanguage_key:"",display_priority:0};T.__proto__=X;var G={element_type:"SubmitButton",label_multilanguage_key:"",display_priority:0};G.__proto__=X;var R={value:"",label_multilanguage_key:"",requirement_setting:0,multiple_values_setting:0,user_enabled_setting:0,display_priority:10,hidden:false,help_text:""};R.__proto__=X;var ag={value_type:"unicode",element_type:"Text",use_as_address_setting:false,number_of_lines_setting:0};ag.__proto__=R;var ae={value_type:"unicode",element_type:"Link"};ae.__proto__=R;var L={element_type:"Password"};L.__proto__=ag;var J={element_type:"Code",display_priority:0};J.__proto__=ag;var E={value_type:"key",element_type:"MultilanguageText",list_priority:0};E.__proto__=R;var O={value_type:"number",element_type:"Choice",choices:{},value:0};O.__proto__=R;var M={value_type:"unicode",element_type:"DateTimeLanguageChoice"};M.__proto__=R;var ab={value_type:"unicode",element_type:"ColorChoice"};ab.__proto__=R;var aa={value_type:"file",element_type:"FileChoice"};aa.__proto__=R;var N={value_type:"key",element_type:"ApplicationChoice"};N.__proto__=R;var H={value_type:"key",element_type:"TemplateChoice"};H.__proto__=R;var Q={value_type:"key",element_type:"TargetFieldChoice",proto_key:""};Q.__proto__=R;var ad={value_type:"key",element_type:"OwnFieldChoice"};ad.__proto__=R;var ah={value_type:"key",element_type:"Relation",parent_application_setting:"",parent_application_element:"",parent_entity_proto_setting:"",cardinality_setting:1,automatically_embed_on_parent:true,display_priority:0,allow_new_cards:false,couchdb_viewname:""};ah.__proto__=R;var I={value:false,value_type:"boolean",element_type:"YesNo"};I.__proto__=R;var P={value_type:"date",element_type:"DateTime"};P.__proto__=R;var F={value_type:"number",element_type:"Number"};F.__proto__=R;var V={value:[],multiple_values_setting:1};V.__proto__=R;var U={value_type:"unicode",element_type:"Text",use_as_address_setting:false};U.__proto__=V;var Y={value_type:"attachment",element_type:"Attachments",label_multilanguage_key:ML_KEYS.attachments};Y.__proto__=R;var af={value_type:"key",element_type:"Relation",parent_application_setting:"",parent_entity_proto_setting:"",cardinality_setting:2,show_short_name_setting:false,show_modified_setting:false,show_modifier_setting:false,show_created_setting:false,show_creator_setting:false,show_card_type:false,allow_new_cards:false,couchdb_viewname:""};af.__proto__=V;var K={element_type:"LanguageChoice",grid_size_setting:1,limit_variations_to_selected_languages:false,map_to_multilanguage_proto:false};K.__proto__=af;return{StaticTableview:W,StaticSubmitButton:G,StaticButton:T,StaticTextField:ag,StaticLinkField:ae,StaticPasswordField:L,StaticCodeField:J,StaticMultilanguageTextField:E,StaticChoiceField:O,DateTimeLanguageChoiceField:M,StaticColorChoiceField:ab,StaticFileChoiceField:aa,StaticOwnFieldChoiceField:ad,StaticTargetFieldChoiceField:Q,StaticRelationField:ah,StaticDateTimeField:P,StaticNumberField:F,StaticYesNoField:I,StaticMultiLanguageChoiceField:K,StaticMultivalueTextField:U,StaticAttachmentField:Y,StaticOneToManyRelationField:af,StaticApplicationChoiceField:N,StaticTemplateChoiceField:H}}function mod_card_structure(){var W=mod_helper();var P=mod_design_element_structure();var N={_id:"",modification_log:[],reader_role_key:"",design_elements:[]};
var J={proto_key:""};J.__proto__=N;var C={proto_key:"&&multilanguageProto"};C.__proto__=J;var A={title_multilanguage_key:ML_KEYS.definition_key,user_creatable:false,hidden:false};A.__proto__=N;var z={definition_type:"Log",title_multilanguage_key:ML_KEYS.log_definition};z.__proto__=A;var K={definition_type:"Error",title_multilanguage_key:ML_KEYS.error_definition,readonly:true};K.__proto__=A;var D={name:"",type:"user",roles:[],definition_type:"User",post_save_action:"synchronize_admin_accounts",title_multilanguage_key:ML_KEYS.user_definition_key,user_creatable:true,script_library:SCRIPT_LIBRARY_KEYS.users,design_elements:[Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.first_name},name:{value:"first_name"}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.last_name},name:{value:"last_name"}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.email},name:{value:"email"},requirement_setting:{value:1}}),Object.create(P.StaticPasswordField,{label_multilanguage_key:{value:ML_KEYS.password},name:{value:"password"},display_priority:{value:0}}),Object.create(P.StaticPasswordField,{label_multilanguage_key:{value:ML_KEYS.password_again},name:{value:"password_again"},display_priority:{value:0}}),Object.create(P.StaticOneToManyRelationField,{label_multilanguage_key:{value:ML_KEYS.assigned_roles},name:{value:"assigned_roles"},parent_application_setting:{value:"roles"},parent_entity_proto_setting:{value:"RoleDefinition"},show_to_users:{value:4}}),Object.create(P.StaticMultiLanguageChoiceField,{label_multilanguage_key:{value:ML_KEYS.languages},name:{value:"languages"},display_priority:{value:3},help_text:{value:ML_KEYS.user_languages_help_text}}),Object.create(P.DateTimeLanguageChoiceField,{label_multilanguage_key:{value:ML_KEYS.date_format_language},name:{value:"date_format_language"},display_priority:{value:3},help_text:{value:ML_KEYS.date_format_language_helptext}})]};D.__proto__=A;var X={definition_type:"Role",title_multilanguage_key:ML_KEYS.role_definition_key,user_creatable:true,design_elements:[Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.role_name},name:{value:"role_name"},requirement_setting:{value:1}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.comment},name:{value:"comment"},grid_size_setting:{value:1},number_of_lines_setting:{value:1},display_priority:{value:7}})]};X.__proto__=A;var H={definition_type:"ScriptLibrary",title_multilanguage_key:ML_KEYS.script_library_definition_key,user_creatable:true,design_elements:[Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.name_key},name:{value:"name"},requirement_setting:{value:1}}),Object.create(P.StaticCodeField,{label_multilanguage_key:{value:ML_KEYS.code_key},name:{value:"code"},display_priority:{value:0}})]};H.__proto__=A;var M={definition_type:"Proto",title_multilanguage_key:ML_KEYS.proto_definition_key,user_creatable:true,design_elements:[Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.name_key},name:{value:"name"},display_priority:{value:10},requirement_setting:{value:1},help_text:{value:ML_KEYS.proto_name_help_text}}),Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.plural_name},name:{value:"plural_name"},display_priority:{value:5},help_text:{value:ML_KEYS.proto_plural_name_help_text}}),Object.create(P.StaticColorChoiceField,{label_multilanguage_key:{value:ML_KEYS.theme_color},name:{value:"theme_color"},display_priority:{value:9},help_text:{value:ML_KEYS.proto_theme_color_helptext}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.enable_attachments},value:{value:false},display_priority:{value:6},name:{value:"enable_attachments"}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.enable_filtering_for_id},value:{value:false},display_priority:{value:6},name:{value:"enable_filtering_for_id"},help_text:{value:ML_KEYS.proto_enable_filtering_help_text},hidden:{value:true}}),Object.create(P.StaticRelationField,{label_multilanguage_key:{value:ML_KEYS.script_library},name:{value:"script_library"},parent_entity_proto_setting:{value:"ScriptLibraryDefinition"},display_priority:{value:0},help_text:{value:ML_KEYS.proto_script_library_help_text}}),Object.create(P.StaticChoiceField,{label_multilanguage_key:{value:ML_KEYS.show_cards_to_users},name:{value:"show_cards_to_users"},display_priority:{value:7},choices:{value:{0:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.all_application_users},name:{value:"all_application_users"}}),1:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.users_related_to_card_and_editors},name:{value:"users_related_to_card_and_editors"}}),2:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.only_editors},name:{value:"only_editors"}}),4:Object.create(P.StaticMultilanguageTextField,{name:{value:"only_admins"},hidden:{value:true}})}},help_text:{value:ML_KEYS.show_cards_to_users_help_text}}),Object.create(P.StaticChoiceField,{label_multilanguage_key:{value:ML_KEYS.allow_editing_cards_to_users},name:{value:"allow_editing_cards_to_users"},display_priority:{value:7},choices:{value:{0:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.edit_access_users_related_to_card_and_editors},name:{value:"users_related_to_card_and_editors"}}),1:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.edit_access_editors_only},name:{value:"editors_only"}})}},help_text:{value:ML_KEYS.allow_editing_cards_to_users_help_text}}),Object.create(P.StaticRelationField,{label_multilanguage_key:{value:ML_KEYS.editor_role},name:{value:"editor_role"},parent_entity_proto_setting:{value:"RoleDefinition"},parent_application_setting:{value:"roles"},display_priority:{value:7},help_text:{value:ML_KEYS.editor_role_help_text}}),Object.create(P.StaticRelationField,{label_multilanguage_key:{value:ML_KEYS.creator_role},name:{value:"creator_role"},parent_entity_proto_setting:{value:"RoleDefinition"},parent_application_setting:{value:"roles"},display_priority:{value:6},help_text:{value:ML_KEYS.creator_role_help_text}}),Object.create(P.StaticRelationField,{label_multilanguage_key:{value:ML_KEYS.automatically_created_tableview_proto},name:{value:"automatically_created_tableview_proto"},value:{value:""},user_enabled_setting:{value:2},display_priority:{value:0},help_text:{value:ML_KEYS.proto_automatic_tableview_help_text}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.comment},name:{value:"comment"},grid_size_setting:{value:1},number_of_lines_setting:{value:1},display_priority:{value:7}}),Object.create(P.StaticOneToManyRelationField,{label_multilanguage_key:{value:ML_KEYS.design_elements},allow_new_cards:{value:true},name:{value:"card_design_elements"},display_priority:{value:7},show_card_type:{value:true},parent_entity_proto_setting:{value:"DesignElementDefinition"}}),Object.create(P.StaticTableview,{label_multilanguage_key:{value:ML_KEYS.cards_based_on_this},name:{value:"cards_based_on_this"},show_short_name_setting:{value:true}})]};
M.__proto__=A;var E={_id:"&&environmentProperties",definition_type:"EnvironmentProperties",title_multilanguage_key:ML_KEYS.environment_properties_title,script_library:SCRIPT_LIBRARY_KEYS.environment_properties,design_elements:[Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.environment_name},name:{value:"name"},use_as_address_setting:{value:true},hidden:{value:true}}),Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.environment_title},name:{value:"environment_title"},display_priority:{value:10},help_text:{value:ML_KEYS.environment_title_help_text}}),Object.create(P.StaticMultilanguageTextField,{name:{value:"billing_agreement"},grid_size_setting:{value:1},number_of_lines_setting:{value:1},user_enabled_setting:{value:2},value:{value:ML_KEYS.billing_agreement_content},disable_label:{value:true}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.invoice_amount},name:{value:"invoice_amount"},user_enabled_setting:{value:2},grid_size_setting:{value:1},number_of_lines_setting:{value:1}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.company_name_for_invoice},name:{value:"company_name_for_invoice"},help_text:{value:ML_KEYS.company_name_for_invoice_help_text}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.email_for_invoice},name:{value:"email_for_invoice"},help_text:{value:ML_KEYS.email_for_invoice_help_text}}),Object.create(P.StaticChoiceField,{label_multilanguage_key:{value:ML_KEYS.currency_for_invoice},name:{value:"currency_for_invoice"},choices:{value:{0:Object.create(P.StaticTextField,{value:{value:"CHF"},name:{value:"chf"}}),1:Object.create(P.StaticTextField,{value:{value:"EUR"},name:{value:"eur"}}),2:Object.create(P.StaticTextField,{value:{value:"USD"},name:{value:"usd"}})}},value:{value:0}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.invoice_contact},name:{value:"invoice_contact"},help_text:{value:ML_KEYS.invoice_contact_help_text}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.invoice_department},name:{value:"invoice_department"},help_text:{value:ML_KEYS.invoice_department_help_text}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.invoice_address},name:{value:"invoice_address"},help_text:{value:ML_KEYS.invoice_address_help_text}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.invoice_zipcode},name:{value:"invoice_zipcode"},help_text:{value:ML_KEYS.invoice_zipcode_help_text}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.invoice_city},name:{value:"invoice_city"},help_text:{value:ML_KEYS.invoice_city_help_text}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.invoice_country},name:{value:"invoice_country"},help_text:{value:ML_KEYS.invoice_country_help_text}}),Object.create(P.StaticMultilanguageTextField,{name:{value:"additional_contact_section"},grid_size_setting:{value:1},number_of_lines_setting:{value:1},user_enabled_setting:{value:2},value:{value:ML_KEYS.additional_contact_section},disable_label:{value:true}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.administrative_contact_email},name:{value:"administrative_contact_email"},help_text:{value:ML_KEYS.administrative_contact_email_help_text}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.technical_contact_email},name:{value:"technical_contact_email"},help_text:{value:ML_KEYS.technical_contact_email_help_text}}),Object.create(P.StaticMultilanguageTextField,{name:{value:"agreement_section"},grid_size_setting:{value:1},number_of_lines_setting:{value:1},user_enabled_setting:{value:2},value:{value:ML_KEYS.agreement_section},disable_label:{value:true}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.hereby_agree},name:{value:"hereby_agree"},value:{value:false}})]};E.__proto__=A;var T={_id:"&&applicationProperties",definition_type:"ApplicationProperties",enable_attachments:true,title_multilanguage_key:ML_KEYS.application_properties_key,design_elements:[Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.url_name_key},name:{value:"name"},use_as_address_setting:{value:true},requirement_setting:{value:1},help_text:{value:ML_KEYS.application_properties_name_help_text}}),Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.title_key},name:{value:"title"},help_text:{value:ML_KEYS.application_properties_title_help_text}}),Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.description_key},name:{value:"description"},help_text:{value:ML_KEYS.application_properties_description_help_text},grid_size_setting:{value:1}}),Object.create(P.StaticLinkField,{label_multilanguage_key:{value:ML_KEYS.icon_url},name:{value:"icon_url"},help_text:{value:ML_KEYS.icon_url_help_text}}),Object.create(P.StaticColorChoiceField,{label_multilanguage_key:{value:ML_KEYS.theme_color},name:{value:"theme_color"},help_text:{value:ML_KEYS.theme_color_helptext}}),Object.create(P.StaticRelationField,{label_multilanguage_key:{value:ML_KEYS.default_card},name:{value:"default_card"},help_text:{value:ML_KEYS.application_properties_default_card_help_text},couchdb_viewname:{value:"navroot_candidates"}}),Object.create(P.StaticMultiLanguageChoiceField,{label_multilanguage_key:{value:ML_KEYS.languages},name:{value:"languages"},value:{value:["en"]},display_priority:{value:6},help_text:{value:ML_KEYS.application_properties_languages_help_text},limit_variations_to_selected_languages:{value:true},map_to_multilanguage_proto:{value:true}}),Object.create(P.StaticRelationField,{label_multilanguage_key:{value:ML_KEYS.full_access_role},name:{value:"full_access_role"},parent_entity_proto_setting:{value:"RoleDefinition"},parent_application_setting:{value:"roles"},requirement_setting:{value:1},display_priority:{value:7},help_text:{value:ML_KEYS.full_access_role_help_text}}),Object.create(P.StaticRelationField,{label_multilanguage_key:{value:ML_KEYS.user_access_role},name:{value:"user_access_role"},parent_entity_proto_setting:{value:"RoleDefinition"},parent_application_setting:{value:"roles"},display_priority:{value:7},help_text:{value:ML_KEYS.user_access_role_help_text}}),Object.create(P.StaticRelationField,{label_multilanguage_key:{value:ML_KEYS.show_in_environment_role},name:{value:"show_in_environment_role"},parent_entity_proto_setting:{value:"RoleDefinition"},parent_application_setting:{value:"roles"},display_priority:{value:6},help_text:{value:ML_KEYS.show_in_environment_role_help_text}}),Object.create(P.StaticTemplateChoiceField,{label_multilanguage_key:{value:ML_KEYS.design_from_template},display_priority:{value:6},name:{value:"design_from_template"},help_text:{value:ML_KEYS.application_properties_template_help_text},hidden:{value:true}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.comment},name:{value:"comment"},grid_size_setting:{value:1},number_of_lines_setting:{value:1}}),Object.create(P.StaticTableview,{label_multilanguage_key:{value:ML_KEYS.protos_tableview_label},name:{value:"protos"},show_short_name_setting:{value:true},entity_proto_setting:{value:"ProtoDefinition"},help_text:{value:ML_KEYS.protos_tableview_helptext}}),Object.create(P.StaticOneToManyRelationField,{label_multilanguage_key:{value:ML_KEYS.menu_definitions},name:{value:"menu_definitions"},allow_new_cards:{value:true},parent_entity_proto_setting:{value:"MenuDefinition"},help_text:{value:ML_KEYS.application_properties_menus_help_text}})]};
T.__proto__=A;var F={_id:"&&importExportCard",definition_type:"ImportExportCard",title_multilanguage_key:ML_KEYS.import_export_title_key,design_elements:[Object.create(P.StaticButton,{label_multilanguage_key:{value:ML_KEYS.rollout_ios}})]};F.__proto__=A;var Q={definition_type:"Login",persistent:false,title_multilanguage_key:ML_KEYS.login_definition_key,hide_share_button:true,design_elements:[Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.email_or_userid},name:{value:"email_or_userid"}}),Object.create(P.StaticPasswordField,{label_multilanguage_key:{value:ML_KEYS.password},name:{value:"password"}}),Object.create(P.StaticSubmitButton,{label_multilanguage_key:{value:ML_KEYS.login_button_label}})]};Q.__proto__=A;var B={definition_type:"Menu",user_creatable:true,title_multilanguage_key:ML_KEYS.menu_definition_key,design_elements:[Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.menu_title_key},name:{value:"title"}}),Object.create(P.StaticOneToManyRelationField,{label_multilanguage_key:{value:ML_KEYS.menu_entries},name:{value:"menu_entries"},show_short_name_setting:{value:true}})]};B.__proto__=A;var O={definition_type:"DesignElement",design_elements:[Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.label_key},name:{value:"label"},requirement_setting:{value:1},display_priority:{value:10},help_text:{value:ML_KEYS.design_element_label_helptext}}),Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.help_text},name:{value:"help_text"},display_priority:{value:6},help_text:{value:ML_KEYS.design_element_helptext_helptext}}),Object.create(P.StaticTextField,{label_multilanguage_key:{value:ML_KEYS.comment},name:{value:"comment"},display_priority:{value:5},grid_size_setting:{value:1},number_of_lines_setting:{value:1}})]};O.__proto__=A;var L={definition_type:"TableView",title_multilanguage_key:ML_KEYS.tableview_definition_key,user_creatable:true,list_priority:5,element_type:"TableView",couchdb_viewname:""};L.__proto__=O;L.design_elements=W.extend(L.design_elements,[Object.create(P.StaticApplicationChoiceField,{label_multilanguage_key:{value:ML_KEYS.parent_application_setting},display_priority:{value:6},name:{value:"application_setting"},help_text:{value:ML_KEYS.application_setting_helptext}}),Object.create(P.StaticRelationField,{label_multilanguage_key:{value:ML_KEYS.parent_entity_proto_setting},display_priority:{value:7},parent_entity_proto_setting:{value:"ProtoDefinition"},parent_application_element:{value:"application_setting"},name:{value:"entity_proto_setting"},help_text:{value:ML_KEYS.proto_setting_helptext},couchdb_viewname:{value:"data_protos"}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.show_keys_setting},display_priority:{value:5},name:{value:"show_keys_setting"}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.show_short_name_setting},display_priority:{value:5},name:{value:"show_short_name_setting"}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.show_modified_setting},display_priority:{value:5},name:{value:"show_modified_setting"},value:{value:true}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.show_modifier_setting},display_priority:{value:5},name:{value:"show_modifier_setting"},value:{value:true}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.show_created_setting},display_priority:{value:5},name:{value:"show_created_setting"},value:{value:true}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.show_creator_setting},display_priority:{value:5},name:{value:"show_creator_setting"},value:{value:true}})]);var R={definition_type:"Field",title_multilanguage_key:ML_KEYS.field_definition_key};R.__proto__=O;R.design_elements=W.extend(R.design_elements,[Object.create(P.StaticChoiceField,{label_multilanguage_key:{value:ML_KEYS.requirement_setting},name:{value:"requirement_setting"},display_priority:{value:7},choices:{value:{0:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.optional},name:{value:"optional"}}),1:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.mandatory},name:{value:"mandatory"}})}}}),Object.create(P.StaticChoiceField,{label_multilanguage_key:{value:ML_KEYS.user_enabled_setting},name:{value:"user_enabled_setting"},display_priority:{value:7},choices:{value:{0:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.editable},name:{value:"editable"}}),1:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.before_first_save},name:{value:"before_first_save"}}),2:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.computed},name:{value:"computed"}})}},help_text:{value:ML_KEYS.user_enabled_setting_helptext}}),Object.create(P.StaticNumberField,{label_multilanguage_key:{value:ML_KEYS.display_priority_setting},name:{value:"display_priority"},display_priority:{value:5},value:{value:10},help_text:{value:ML_KEYS.display_priority_setting_helptext}}),Object.create(P.StaticChoiceField,{label_multilanguage_key:{value:ML_KEYS.grid_size_setting},name:{value:"grid_size_setting"},display_priority:{value:6},choices:{value:{0:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.one_column},name:{value:"one_column"}}),1:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.entire_row},name:{value:"entire_row"}})}}})]);
var I={definition_type:"TextField",value_type:"unicode",element_type:"Text",list_priority:10,title_multilanguage_key:ML_KEYS.text_field_definition_key,user_creatable:true};I.__proto__=R;I.design_elements=W.extend(I.design_elements,[Object.create(P.StaticChoiceField,{label_multilanguage_key:{value:ML_KEYS.number_of_lines_setting},display_priority:{value:5},name:{value:"number_of_lines_setting"},value:{value:0},choices:{value:{0:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.single_line},name:{value:"single_line"}}),1:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.multi_line},name:{value:"multi_line"}})}}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.use_as_address_setting},display_priority:{value:5},name:{value:"use_as_address_setting"},hidden:{value:true}})]);var G={definition_type:"NumberField",value_type:"number",element_type:"Number",list_priority:9,title_multilanguage_key:ML_KEYS.number_field_definition_key,user_creatable:true};G.__proto__=R;var V={definition_type:"RelationField",value_type:"key",element_type:"Relation",display_priority:0,list_priority:5,title_multilanguage_key:ML_KEYS.relation_field_definition_key,user_creatable:true};V.__proto__=R;V.design_elements=W.extend(V.design_elements,[Object.create(P.StaticApplicationChoiceField,{label_multilanguage_key:{value:ML_KEYS.parent_application_setting},display_priority:{value:6},name:{value:"parent_application_setting"},help_text:{value:ML_KEYS.parent_application_setting_helptext}}),Object.create(P.StaticRelationField,{label_multilanguage_key:{value:ML_KEYS.parent_entity_proto_setting},display_priority:{value:7},parent_application_element:{value:"parent_application_setting"},name:{value:"parent_entity_proto_setting"},parent_entity_proto_setting:{value:"ProtoDefinition"},help_text:{value:ML_KEYS.parent_entity_proto_setting_helptext},couchdb_viewname:{value:"data_protos"}}),Object.create(P.StaticChoiceField,{label_multilanguage_key:{value:ML_KEYS.presentation_setting},display_priority:{value:7},name:{value:"presentation_setting"},value:{value:0},choices:{value:{0:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.selection},name:{value:"selection"}}),1:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.table_existing},name:{value:"table_existing"}}),2:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.table_new},name:{value:"table_new"}})}},help_text:{value:ML_KEYS.presentation_setting_helptext}}),Object.create(P.StaticChoiceField,{hidden:{value:true},label_multilanguage_key:{value:ML_KEYS.cardinality_setting},display_priority:{value:7},name:{value:"cardinality_setting"},value:{value:1},choices:{value:{0:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.one_to_one},name:{value:"one_to_one"},hidden:{value:true}}),1:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.many_to_one},name:{value:"many_to_one"}}),2:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.one_to_many},name:{value:"one_to_many"}})}},help_text:{value:ML_KEYS.cardinality_setting_helptext}}),Object.create(P.StaticYesNoField,{hidden:{value:true},label_multilanguage_key:{value:ML_KEYS.allow_new_cards},value:{value:false},display_priority:{value:5},name:{value:"allow_new_cards"},help_text:{value:ML_KEYS.allow_new_cards_setting_helptext}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.filter_automatically_setting},value:{value:true},display_priority:{value:5},name:{value:"filter_automatically_setting"},help_text:{value:ML_KEYS.filter_automatically_setting_helptext}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.enable_filtering},value:{value:false},display_priority:{value:7},name:{value:"enable_filtering"},help_text:{value:ML_KEYS.enable_filtering_helptext}}),Object.create(P.StaticYesNoField,{hidden:{value:true},label_multilanguage_key:{value:ML_KEYS.automatically_embed_on_parent},value:{value:true},display_priority:{value:5},name:{value:"automatically_embed_on_parent"}})]);
var S={definition_type:"UserRelationField",value_type:"key",element_type:"Relation",display_priority:0,list_priority:4,title_multilanguage_key:ML_KEYS.user_relation_field_definition_key,user_creatable:true,parent_application_setting:"_users",parent_entity_proto_setting:"UserDefinition"};S.__proto__=R;S.design_elements=W.extend(S.design_elements,[Object.create(P.StaticChoiceField,{label_multilanguage_key:{value:ML_KEYS.cardinality_setting},display_priority:{value:7},name:{value:"cardinality_setting"},value:{value:1},choices:{value:{1:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.many_to_one},name:{value:"many_to_one"}}),2:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.one_to_many},name:{value:"one_to_many"}})}},help_text:{value:ML_KEYS.cardinality_setting_helptext}}),Object.create(P.StaticYesNoField,{label_multilanguage_key:{value:ML_KEYS.enable_filtering},value:{value:false},display_priority:{value:7},name:{value:"enable_filtering"},help_text:{value:ML_KEYS.enable_filtering_helptext}})]);var U={definition_type:"DateTimeField",value_type:"date",element_type:"DateTime",user_creatable:true,list_priority:8,title_multilanguage_key:ML_KEYS.datetime_field_definition_key};U.__proto__=R;U.design_elements=W.extend(U.design_elements,[Object.create(P.StaticChoiceField,{label_multilanguage_key:{value:ML_KEYS.datetime_display_setting},display_priority:{value:5},name:{value:"datetime_display_setting"},value:{value:0},choices:{value:{0:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.datetime},name:{value:"datetime"}}),1:Object.create(P.StaticMultilanguageTextField,{label_multilanguage_key:{value:ML_KEYS.date_only},name:{value:"date_only"}})}},help_text:{value:ML_KEYS.datetime_display_setting_helptext}})]);return{DynamicCard:J,StaticCard:A,LogDefinition:z,ErrorDefinition:K,MultilanguageCard:C,ScriptLibraryDefinition:H,ProtoDefinition:M,UserDefinition:D,RoleDefinition:X,EnvironmentPropertiesDefinition:E,ApplicationPropertiesDefinition:T,LoginDefinition:Q,MenuDefinition:B,ImportExportCardDefinition:F,DesignElementDefinition:O,TextFieldDefinition:I,TableViewDefinition:L,FieldDefinition:R,RelationFieldDefinition:V,UserRelationFieldDefinition:S,DateTimeFieldDefinition:U,NumberFieldDefinition:G}}function mod_template_helper(){function b(f,a,h){if(!(Array.isArray(f))){return}if(a===undefined){a={}}if(h===undefined){h={}}for(var g=0;g<f.length;g++){if(f[g].readonly===true){a[f[g]._id]=f[g];if(f[g]._id in h){delete h[f[g]._id]}}else{h[f[g]._id]=f[g];if(f[g]._id in a){delete a[f[g]._id]}}}}return{add_to_template:b}}function mod_minimal_template(){var ak=mod_helper();var S=mod_template_helper();var Q=mod_card_structure();var aa=[];var U={show_cards_to_users:4};U.__proto__=Q.ApplicationPropertiesDefinition;U.design_elements=ak.extend(U.design_elements,[{name:"menu_definitions",value:["&&designMenuDefinition","&&adminMenuDefinition","&&userMenuDefinition"]}]);aa.push(U);var V={_id:"&&importExportCard"};V.__proto__=Q.ImportExportCardDefinition;aa.push(V);var aj={_id:"&&multilanguageProto",hidden:true};aj.__proto__=Q.ProtoDefinition;aj.design_elements=ak.extend(aj.design_elements,[{name:"card_design_elements",value:["en"]}]);aa.push(aj);var al={_id:"en",readonly:true,design_elements:[{name:"grid_size_setting",value:1},{name:"number_of_lines_setting",value:1}]};al.__proto__=Q.TextFieldDefinition;aa.push(al);var O={_id:"&&protosTableViewDefinition",readonly:true};O.__proto__=Q.TableViewDefinition;O.design_elements=ak.extend(O.design_elements,[{name:"entity_proto_setting",value:"ProtoDefinition"},{name:"show_card_type",value:true}]);aa.push(O);var Y={_id:"&&protosTableViewProto",readonly:true,hidden:true};Y.__proto__=Q.ProtoDefinition;Y.design_elements=ak.extend(Y.design_elements,[{name:"name",value:ML_KEYS.protos_tableview_title},{name:"card_design_elements",value:["&&protosTableViewDefinition"]},{name:"show_cards_to_users",value:4}]);aa.push(Y);var G={_id:"&&protosTableViewCard",proto_key:"&&protosTableViewProto",readonly:true};
G.__proto__=Q.DynamicCard;aa.push(G);var K={_id:"&&allTableViewDefinition",readonly:true};K.__proto__=Q.TableViewDefinition;K.design_elements=ak.extend(K.design_elements,[{name:"entity_proto_setting",value:""},{name:"show_keys_setting",value:true},{name:"show_short_name_setting",value:true},{name:"show_modified_setting",value:true}]);aa.push(K);var af={_id:"&&allTableViewProto",readonly:true,hidden:true};af.__proto__=Q.ProtoDefinition;af.design_elements=ak.extend(af.design_elements,[{name:"name",value:ML_KEYS.all_tableview_title},{name:"card_design_elements",value:["&&allTableViewDefinition"]},{name:"show_cards_to_users",value:4}]);aa.push(af);var H={_id:"&&allTableViewCard",proto_key:"&&allTableViewProto",readonly:true};H.__proto__=Q.DynamicCard;aa.push(H);var M={_id:"&&multilanguageTableViewDefinition",readonly:true};M.__proto__=Q.TableViewDefinition;M.design_elements=ak.extend(M.design_elements,[{name:"entity_proto_setting",value:"&&multilanguageProto"},{name:"show_keys_setting",value:true},{name:"help_text",value:ML_KEYS.ml_definitions_tableview_helptext}]);aa.push(M);var ac={_id:"&&multilanguageTableViewProto",readonly:true,hidden:true};ac.__proto__=Q.ProtoDefinition;ac.design_elements=ak.extend(ac.design_elements,[{name:"name",value:ML_KEYS.multilanguage_tableview_title},{name:"card_design_elements",value:["&&multilanguageTableViewDefinition"]},{name:"show_cards_to_users",value:4}]);aa.push(ac);var W={_id:"&&multilanguageTableViewCard",proto_key:"&&multilanguageTableViewProto",readonly:true};W.__proto__=Q.DynamicCard;aa.push(W);var X={_id:"&&logTableViewDefinition",readonly:true};X.__proto__=Q.TableViewDefinition;X.design_elements=ak.extend(X.design_elements,[{name:"entity_proto_setting",value:"LogDefinition"},{name:"show_modified_setting",value:true}]);aa.push(X);var N={_id:"&&logTableViewProto",readonly:true,hidden:true};N.__proto__=Q.ProtoDefinition;N.design_elements=ak.extend(N.design_elements,[{name:"name",value:ML_KEYS.log_tableview_title},{name:"card_design_elements",value:["&&logTableViewDefinition"]},{name:"show_cards_to_users",value:4}]);aa.push(N);var T={_id:"&&logTableViewCard",proto_key:"&&logTableViewProto",readonly:true};T.__proto__=Q.DynamicCard;aa.push(T);var ah={_id:"&&trashTableViewDefinition",readonly:true,couchdb_viewname:"deleted"};ah.__proto__=Q.TableViewDefinition;ah.design_elements=ak.extend(ah.design_elements,[{name:"show_keys_setting",value:true},{name:"show_short_name_setting",value:true},{name:"show_modified_setting",value:true}]);aa.push(ah);var ae={_id:"&&trashTableViewProto",hidden:true};ae.__proto__=Q.ProtoDefinition;ae.design_elements=ak.extend(ae.design_elements,[{name:"name",value:ML_KEYS.trash_tableview_title},{name:"card_design_elements",value:["&&trashTableViewDefinition"]}]);aa.push(ae);var ad={_id:"&&trashTableViewCard",proto_key:"&&trashTableViewProto",readonly:true};ad.__proto__=Q.DynamicCard;aa.push(ad);var ai={_id:"&&scriptLibraryTableViewDefinition",readonly:true};ai.__proto__=Q.TableViewDefinition;ai.design_elements=ak.extend(ai.design_elements,[{name:"entity_proto_setting",value:"ScriptLibraryDefinition"}]);aa.push(ai);var I={_id:"&&scriptLibraryTableViewProto",readonly:true,hidden:true};I.__proto__=Q.ProtoDefinition;I.design_elements=ak.extend(I.design_elements,[{name:"name",value:ML_KEYS.scriptlibrary_tableview_title},{name:"card_design_elements",value:["&&scriptLibraryTableViewDefinition"]},{name:"show_cards_to_users",value:4}]);aa.push(I);var R={_id:"&&scriptLibraryTableViewCard",proto_key:"&&scriptLibraryTableViewProto",readonly:true};R.__proto__=Q.DynamicCard;aa.push(R);var L={_id:"&&designMenuDefinition",readonly:true};L.__proto__=Q.MenuDefinition;L.design_elements=ak.extend(L.design_elements,[{name:"title",value:ML_KEYS.design_menu_header},{name:"menu_entries",value:["&&applicationProperties","&&protosTableViewCard","&&scriptLibraryTableViewCard","&&multilanguageTableViewCard"]}]);aa.push(L);var P={_id:"&&adminMenuDefinition"};P.__proto__=Q.MenuDefinition;P.design_elements=ak.extend(P.design_elements,[{name:"title",value:ML_KEYS.admin_menu_header},{name:"menu_entries",value:["&&allTableViewCard","&&logTableViewCard","&&trashTableViewCard","&&importExportCard"]}]);
aa.push(P);var ag={_id:"&&userMenuDefinition"};ag.__proto__=Q.MenuDefinition;ag.design_elements=ak.extend(ag.design_elements,[{name:"title",value:ML_KEYS.main_menu_header}]);aa.push(ag);var J={_id:"&&baseDateTimeDefinition",readonly:true};J.__proto__=Q.DateTimeFieldDefinition;aa.push(J);var Z={};var ab={};S.add_to_template(aa,ab,Z);return{editable_cards_by_key:Z,readonly_cards_by_key:ab}}function mod_users_template(){var q=mod_helper();var t=mod_template_helper();var r=mod_card_structure();minimal_template=mod_minimal_template();var l=q.clone(minimal_template.readonly_cards_by_key);for(key in minimal_template.editable_cards_by_key){var p=q.clone(minimal_template.editable_cards_by_key[key]);p.readonly=true;l[key]=p}for(key in l){l[key].persistent=false}var u=[];var o={readonly:true,persistent:false};o.__proto__=r.ApplicationPropertiesDefinition;o.design_elements=q.extend(o.design_elements,[{name:"name",value:"users"},{name:"title",value:ML_KEYS.users_app_title},{name:"icon_url",value:"static/icons/icon_users.png"},{name:"description",value:ML_KEYS.users_app_description},{name:"default_card",value:"&&usersTableViewCard"},{name:"menu_definitions",value:["&&adminMenuDefinition"]}]);u.push(o);var v={_id:"&&usersTableViewDefinition",readonly:true,persistent:false};v.__proto__=r.TableViewDefinition;v.design_elements=q.extend(v.design_elements,[{name:"entity_proto_setting",value:"UserDefinition"},{name:"show_short_name_setting",value:true},{name:"show_modified_setting",value:true}]);u.push(v);var n={_id:"&&usersTableViewProto",readonly:true,persistent:false};n.__proto__=r.ProtoDefinition;n.design_elements=q.extend(n.design_elements,[{name:"name",value:ML_KEYS.users_tableview_title},{name:"card_design_elements",value:["&&usersTableViewDefinition"]}]);u.push(n);var s={_id:"&&usersTableViewCard",proto_key:"&&usersTableViewProto",readonly:true,persistent:false};s.__proto__=r.DynamicCard;u.push(s);var m={_id:"&&adminMenuDefinition",readonly:true,persistent:false};m.__proto__=r.MenuDefinition;m.design_elements=q.extend(m.design_elements,[{name:"title",value:ML_KEYS.admin_menu_header},{name:"menu_entries",value:["&&usersTableViewCard","&&trashTableViewCard"]}]);u.push(m);t.add_to_template(u,l);return{editable_cards_by_key:{},readonly_cards_by_key:l}}function mod_roles_template(){var w=mod_helper();var z=mod_template_helper();var y=mod_card_structure();minimal_template=mod_minimal_template();var q=w.clone(minimal_template.readonly_cards_by_key);var s=w.clone(minimal_template.editable_cards_by_key);var A=[];var u={readonly:true};u.__proto__=y.ApplicationPropertiesDefinition;u.design_elements=w.extend(u.design_elements,[{name:"name",value:"roles"},{name:"title",value:ML_KEYS.roles_app_title},{name:"icon_url",value:"static/icons/icon_roles.png"},{name:"description",value:ML_KEYS.roles_app_description},{name:"default_card",value:"&&rolesTableViewCard"},{name:"menu_definitions",value:["&&adminMenuDefinition"]},{name:"full_access_role",value:"&&roleEditorRole"},{name:"show_in_environment_role",value:"&&roleEditorRole"}]);A.push(u);var x={_id:"&&rolesTableViewDefinition",readonly:true};x.__proto__=y.TableViewDefinition;x.design_elements=w.extend(x.design_elements,[{name:"entity_proto_setting",value:"RoleDefinition"},{name:"show_short_name_setting",value:true}]);A.push(x);var B={_id:"&&rolesTableViewProto",readonly:true};B.__proto__=y.ProtoDefinition;B.design_elements=w.extend(B.design_elements,[{name:"name",value:ML_KEYS.roles_tableview_title},{name:"card_design_elements",value:["&&rolesTableViewDefinition"]},{name:"editor_role",value:"&&systemRole"}]);A.push(B);var t={_id:"&&rolesTableViewCard",proto_key:"&&rolesTableViewProto",readonly:true};t.__proto__=y.DynamicCard;A.push(t);var o={_id:"&&systemRole",readonly:true};o.__proto__=y.RoleDefinition;o.design_elements=w.extend(o.design_elements,[{name:"role_name",value:ML_KEYS.system_role},{name:"comment",value:"Has full access to all applications and can edit all users and their roles"}]);A.push(o);var p={_id:"&&applicationCreatorRole",readonly:true};
p.__proto__=y.RoleDefinition;p.design_elements=w.extend(p.design_elements,[{name:"role_name",value:ML_KEYS.application_creator_role}]);A.push(p);var v={_id:"&&roleEditorRole",readonly:true};v.__proto__=y.RoleDefinition;v.design_elements=w.extend(v.design_elements,[{name:"role_name",value:ML_KEYS.role_editor_role},{name:"comment",value:"Can edit all role names. Please note that only environment administrators can change the role assignment to users."}]);A.push(v);var r={_id:"&&adminMenuDefinition",readonly:true};r.__proto__=y.MenuDefinition;r.design_elements=w.extend(r.design_elements,[{name:"menu_entries",value:["&&allTableViewCard","&&rolesTableViewCard","&&trashTableViewCard"]}]);A.push(r);z.add_to_template(A,q,s);return{editable_cards_by_key:s,readonly_cards_by_key:q}}function mod_system_template(){var w=mod_helper();var z=mod_template_helper();var x=mod_card_structure();minimal_template=mod_minimal_template();var p=w.clone(minimal_template.readonly_cards_by_key);var s=w.clone(minimal_template.editable_cards_by_key);var A=[];var t={readonly:true,hidden:true};t.__proto__=x.ApplicationPropertiesDefinition;t.design_elements=w.extend(t.design_elements,[{name:"name",value:"system"},{name:"default_card",value:"&&multilanguageTableViewCard"},{name:"menu_definitions",value:["&&adminMenuDefinition"]},{name:"languages",value:["en","es","de","de_CH"]}]);A.push(t);var q={_id:"&&multilanguageProto",hidden:true};q.__proto__=x.ProtoDefinition;q.design_elements=w.extend(q.design_elements,[{name:"card_design_elements",value:["en","es","de","de_CH","comment"]}]);A.push(q);var B={_id:"en",readonly:true,design_elements:[{name:"grid_size_setting",value:1},{name:"number_of_lines_setting",value:1}]};B.__proto__=x.TextFieldDefinition;A.push(B);var u={_id:"de",readonly:true,design_elements:[{name:"grid_size_setting",value:1},{name:"number_of_lines_setting",value:1}]};u.__proto__=x.TextFieldDefinition;A.push(u);var y={_id:"de_CH",readonly:true,design_elements:[{name:"grid_size_setting",value:1},{name:"number_of_lines_setting",value:1}]};y.__proto__=x.TextFieldDefinition;A.push(y);var v={_id:"es",readonly:true,design_elements:[{name:"grid_size_setting",value:1},{name:"number_of_lines_setting",value:1}]};v.__proto__=x.TextFieldDefinition;A.push(v);var o={_id:"comment",readonly:true,design_elements:[{name:"grid_size_setting",value:1},{name:"number_of_lines_setting",value:1}]};o.__proto__=x.TextFieldDefinition;A.push(o);var r={_id:"&&adminMenuDefinition",readonly:true};r.__proto__=x.MenuDefinition;r.design_elements=w.extend(r.design_elements,[{name:"title",value:ML_KEYS.admin_menu_header},{name:"menu_entries",value:["&&scriptLibraryTableViewCard","&&multilanguageTableViewCard","&&trashTableViewCard"]}]);A.push(r);z.add_to_template(A,p,s);return{editable_cards_by_key:s,readonly_cards_by_key:p}}function mod_environment_properties_template(){var m=mod_helper();var n=mod_template_helper();var j=mod_card_structure();minimal_template=mod_minimal_template();var i=m.clone(minimal_template.readonly_cards_by_key);for(key in minimal_template.editable_cards_by_key){i[key]=m.extend(minimal_template.editable_cards_by_key[key],{readonly:{value:true}})}var k=[];var p={readonly:true,hidden:true};p.__proto__=j.ApplicationPropertiesDefinition;p.design_elements=m.extend(p.design_elements,[{name:"name",value:"environment_properties"},{name:"title",value:ML_KEYS.environment_properties_title},{name:"default_card",value:"&&environmentProperties"},{name:"menu_definitions",value:[]}]);k.push(p);var l={};l.__proto__=j.EnvironmentPropertiesDefinition;k.push(l);var o={};n.add_to_template(k,i,o);return{editable_cards_by_key:o,readonly_cards_by_key:i}}var system_templates_by_key={_users:mod_users_template(),system:mod_system_template(),roles:mod_roles_template(),environment_properties:mod_environment_properties_template()};function mod_validator(m,o,r,t){var s=m;var p=o;var n=t;var u=mod_helper();var q=mod_card_tools(s,p,r,n);function v(d,a,b){var c=d[a];if(c===undefined){d[a]=b}else{d[a]+="\n"+b}}function x(b,c,a,d){if(d===undefined){d=LOG_LEVEL.message}if(a!==undefined){v(b,a,c)}else{v(b,"general",c)}}function w(f,j){if(j===undefined){j={}}if(u.is_empty(f)){return j}var e=q.get_card_type(f);if(e===null){x(j,"invalid card",undefined,LOG_LEVEL.error);return j}var g=u.get_property(f,"design_elements");if(Array.isArray(g)){var i=q.get_element_index(f);for(var d in i){var c=i[d];var b=q.get_design_element_properties(c);var h=u.get_property(b,"value");switch(u.get_property(b,"element_type")){case"Text":if(u.get_property(b,"use_as_address_setting")===true&&!(u.contains_only_ascii_words(String(h)))){var a=q.get_multilanguage_string(ML_KEYS.address_only_ascii_error,"only basic characters, numbers and underscores allowed");x(j,a,d,LOG_LEVEL.message)}break;case"Password":if(!(u.contains_only_ascii_words(String(h)))){var a=q.get_multilanguage_string(ML_KEYS.password_only_ascii_error,"sorry, only English characters, numbers and symbols are allowed for passwords");x(j,a,d,LOG_LEVEL.message)}break}if(u.get_property(b,"requirement_setting")===1){if(h===null||h===undefined||h===""){var a=q.get_multilanguage_string(ML_KEYS.address_field_mandatory_error,"this field is mandatory");x(j,a,d,LOG_LEVEL.message)}}if(u.get_property(b,"value_type")==="number"){if(h!==null&&isNaN(h)){var a=q.get_multilanguage_string(ML_KEYS.only_numbers_accepted,"this field requires a number");x(j,a,d,LOG_LEVEL.message)}}}}return j}return{get_validation_errors:w}};function mod_migrations(o,q){var t=mod_helper();var s=mod_design_element_structure();var p=o;var l=q;var n={"2013-12-18T16:39:47":function(a){m(a,"number_of_lines_setting")},"2013-12-19T13:49:57":function(a){m(a,"grid_size_setting")},"2014-01-24T20:45:49":function(a){m(a,"allow_new_cards")},"2014-01-25T09:32:33":function(a){m(a,"user_enabled_setting")},"2014-01-25T11:34:18":function(a){m(a,"label_multilanguage_key")},"2014-02-10T09:10:55":function(a){m(a,"label_multilanguage_key")},"2014-02-11T09:47:26":function(a){m(a,"parent_application_setting")},"2014-02-18T18:25:23":function(a){m(a,"couchdb_viewname")},"2014-02-25T16:53:25":function(a){if("readonly" in a){delete a.readonly}},"2014-02-25T20:59:06":function(a){m(a,"help_text")},"2014-03-05T10:52:20":function(a){if(a.definition_type!=="User"){return}var b=a.get_value("assigned_roles",[]);if(a.get_value("is_enviroment_manager_setting")===true&&b.indexOf("&&systemRole")===-1){b.push("&&systemRole");if(!(a.set_design_element_value("assigned_roles",b,false))){l.log("could not add a new role - element on user Card not found",LOG_LEVEL.error)}a.roles=t.clone(b)}},"2014-03-07T09:36:12":function(a){if(p.application_key==="roles"&&a._id==="&&applicationProperties"){delete a.design_elements}},"2014-04-28T22:00:00":function(a){if(a.definition_type==="Proto"&&a.hidden===true){delete a.hidden}if(a.definition_type==="TableView"){var b=a.get_design_element("application_setting");if(b!==null&&(typeof(b.value)!=="string"||b.value==="")){b.value=p.application_key}}},"2014-04-29T13:08:33":function(a){m(a,"hidden");if(a.definition_type==="RelationField"){var b=0;var e=1;var d=a.get_design_element("cardinality_setting");if(!(t.is_empty(d))){e=d.value}var c=false;var f=a.get_design_element("allow_new_cards");if(!(t.is_empty(f))){c=f.value}if(e===2&&c===true){b=2}else{if(e===2){b=1}}a.set_design_element_value("presentation_setting",b)}},"2014-05-15T09:33:43":function(a){m(a,"couchdb_viewname");if(a.definition_type==="Proto"){var b=a.get_design_element("cards_based_on_this");if(b!==null){b.entity_proto_setting=a._id}}},"2014-05-15T22:12:43":function(a){m(a,"requirement_setting");m(a,"hidden")},"2014-09-02T05:02:45":function(a){m(a,"user_creatable")},"2015-02-11T15:05:19":function(b){if(b._id==="&&applicationProperties"){m(b,"grid_size_setting");b.design_elements=t.get_purged_list("languages",b.design_elements)}if(b._id==="&&multilanguageProto"){b.design_elements=t.get_purged_list("card_design_elements",b.design_elements)}if(b.proto_key==="&&multilanguageProto"){var a=b.get_value("en_US");if(typeof(a)!=="string"){a=""}b.design_elements=[{definition_key:"en",value:a}]}},"2015-02-27T03:07:55":function(a){if(a.proto_key==="&&multilanguageProto"){var b=a.set_element_value("en_US","",false);if(b===true){l.log("cleared 'en_US' in ML Definition with ID "+a._id+". (upgrade to Protogrid 1.0)",LOG_LEVEL.message)}}}};var r=Object.keys(n).sort();function m(d,b){if(!(Array.isArray(d.design_elements))){return}for(var c=0;c<d.design_elements.length;c++){var a=d.design_elements[c];if(b in a){delete a[b]}}return}function v(){return r[r.length-1]}function u(c){if(c.last_healed>=v()){return}for(var a=0;a<r.length;a++){if(c.last_healed>=r[a]){continue}var b=n[r[a]];b(c)}return}return{migrate_card:u}}function mod_card_tools(cg,a9,bK,bd,bq){var bw=bd;var bE=bq;var bj=mod_helper(bE);var aY=mod_design_element_structure();var bf=mod_card_structure();var aZ=cg;var bJ=a9;var bT=mod_migrations(bJ,bw);var bV=[];var bo=b3();var b5=ba(bo,bK);var bk=b1(bK,bV);var bz=a0();var bt=null;function bA(a){if(a.get_value!==undefined&&a._id==="&&multilanguageProto"){}bj.remove_property(a,"get_key");bj.remove_property(a,"get_type");bj.remove_property(a,"get_proto_key");bj.remove_property(a,"get_design_element");bj.remove_property(a,"get_value");bj.remove_property(a,"set_design_element_value");bj.remove_property(a,"get_design_element_properties");bj.remove_property(a,"temporary_data");if("temporary_data" in a){bw.log("temporary_data could not be removed from card "+a._id,LOG_LEVEL.error)
}}function bc(a){a.get_key=function(){return this._id};a.get_type=function(){return aQ(this)};a.get_proto_key=function(){return this.proto_key};a.get_design_element=function(c){var b=by(this);if(typeof(b[c])!=="object"||b[c]===null){return null}return b[c]};a.get_value=function(b,d){if(d===undefined){d=null}if(b in this){return this[b]}var c=this.get_design_element(b);if(c===null){return d}return c.value};a.get_shortname=function(){return bN(this)};a.set_design_element_value=function(c,b,e){if(typeof(e)!=="boolean"){e=true}var d=this.get_design_element(c);if(d===null&&e===false){this.design_elements.push({name:c,value:b});return true}else{if(d===null){return false}}d.value=b;return true};a.set_element_value=function(c,b,d){return this.set_design_element_value(c,b,d)};a.get_design_element_properties=function(b){var c=this.get_design_element(b);if(c===null){return null}return i(c)};return a}function a0(){var c=Object.keys(LANGUAGE_BY_LOCALE);var a=[];for(var b=0;b<c.length;b++){if(c[b].indexOf("_")!==-1){continue}a.push(c[b])}return a}function b3(){var a=null;if(!(bj.is_empty(system_templates_by_key[bJ.application_key]))){a=system_templates_by_key[bJ.application_key]}else{a=mod_minimal_template()}return a}function ba(d,b){function c(s,t,r,p,q){foreign_template_card=r[s];p[s]=foreign_template_card;foreign_template_card.persistent=false;b[s]=foreign_template_card;q[s]=t}var a=bj.merge(d.readonly_cards_by_key,d.editable_cards_by_key);var l=null;var j=Object.keys(b);var h={};var e=null;for(var k=0;k<j.length;k++){if(j[k].indexOf("&&")==-1){continue}if(j[k] in a){continue}if(l===null){l=Object.keys(system_templates_by_key)}for(var m=0;m<l.length;m++){e=system_templates_by_key[l[m]];if(j[k] in e.readonly_cards_by_key){c(j[k],e,e.readonly_cards_by_key,a,h);break}if(j[k] in e.editable_cards_by_key){c(j[k],e,e.editable_cards_by_key,a,h);break}}}var g=Object.keys(h);for(var n=0;n<g.length;n++){e=h[g[n]];var f=b[g[n]];var o=f.proto_key;if(typeof(o)==="string"&&o!==""){if(o in e.readonly_cards_by_key){c(o,e,e.readonly_cards_by_key,a,h);continue}if(o in e.editable_cards_by_key){c(o,e,e.editable_cards_by_key,a,h);continue}}}return a}function bZ(c){if(Array.isArray(c.design_elements)){c.design_elements=bj.compact(c.design_elements);for(var b=0;b<c.design_elements.length;b++){var a=bj.get_property(c.design_elements[b],"value");if(Array.isArray(a)){c.design_elements[b].value=bj.compact(a)}}}else{c.design_elements=[]}}function b1(a,b){if(b===undefined){b=[]}var d=a;var n=Object.keys(b5);for(var h=0;h<n.length;h++){var c=n[h];var l=null;var g=false;if(c in d){l=d[c];var e=aQ(b5[c]);if(e==="DynamicCard"){l.proto_key=b5[c].proto_key}else{l.definition_type=b5[c].definition_type}}else{l=b5[c]}bZ(l);var m=aQ(l);if(m===null){var k=b5[c];if(k.definition_type!==undefined){l.definition_type=k.definition_type}if(k.proto_key!==undefined){l.proto_key=k.proto_key}m=aQ(l);if(m===null){bw.log("template card with id "+c+" is of unknown type. cannot fix.",LOG_LEVEL.error);continue}g=true}if(typeof(l.last_healed)==="string"&&l.last_healed<STRUCTURE_VERSION){bT.migrate_card(bc(l));g=true}var j=l;if(typeof(j.last_healed)!=="string"||j.last_healed<STRUCTURE_VERSION){var f=bj.extend(bf[m],b5[c]);if(f.readonly===true){j=f}else{j=bj.extend(f,l)}j.last_healed=STRUCTURE_VERSION;g=true}b5[c]=j;d[c]=j;if(g===true){b.push(j)}}return d}function b2(){var a=b3();return Object.keys(a.editable_cards_by_key).concat(Object.keys(a.readonly_cards_by_key))}function bO(){return bV}function bD(a,b){if(b.user_creatable===true){a.push(b)}}function bv(d){var b=[];var h=[];var a=d+"Definition";var e=bf[a];if(e===undefined){bw.log("no structure found with name "+a,LOG_LEVEL.error);return h}var f=0;b[f]=[a];bD(h,e);var j=Object.keys(bf);while(b[f].length>0){f+=1;b[f]=[];for(var g=0;g<j.length;g++){var c=bf[j[g]];var k=c.__proto__.definition_type;if(typeof(k)==="string"&&b[f-1].indexOf(k+"Definition")!==-1){b[f].push(j[g]);bD(h,c)}}}return h}function cc(b,d){if(bj.is_empty(b)){return{}}var a=by(b);
var c=a[d];return i(c)}function bS(a){var e={};if(typeof(a.proto_key)==="string"&&a.proto_key!==""){e[a.proto_key]=["#"]}if(!(Array.isArray(a.design_elements))){return e}for(var g=0;g<a.design_elements.length;g++){var b=a.design_elements[g];var c=bu(b);if(c===null){continue}var d=i(b);if(d.deleted===true){continue}if(typeof(d.parent_entity_proto_setting)==="string"&&d.parent_entity_proto_setting!==""){var f=e[d.parent_entity_proto_setting];if(!(Array.isArray(f))){e[d.parent_entity_proto_setting]=[c]}else{f.push(c)}}}return e}function a6(){var a=aZ.user_card;if(bj.is_empty(a)){return false}if(a.roles.indexOf("&&systemRole")!==-1){return true}if(bj.is_empty(bJ.properties)){return false}var b=by(bJ.properties);if(!(bj.is_empty(b,"full_access_role"))&&b.full_access_role.value!==""){return bU().indexOf(b.full_access_role.value)!==-1}return false}function bU(){var a=aZ.user_card;var b=by(a);if(bj.is_empty(b.assigned_roles)){return[]}if(typeof(b.assigned_roles.value)==="string"){return[b.assigned_roles.value]}if(!(Array.isArray(b.assigned_roles.value))){return[]}return b.assigned_roles.value}function aT(a){if(a.indexOf("org.couchdb.user:")===-1){return"org.couchdb.user:"+a}else{return a}}function bH(g){var a=[];var f=bR(g,"user");a.push(aT(f));var j=by(g);var h=bS(g);var b=h.UserDefinition;if(Array.isArray(b)){for(var d=0;d<b.length;d++){var c=j[b[d]];if(Array.isArray(c.value)){for(var e=0;e<c.value.length;e++){a.push(aT(c.value[e]))}}else{if(typeof(c.value)==="string"&&c.value!==""){a.push(aT(c.value))}}}}return a}function bW(j,e){var c={};c=by(e);var b=null;if(!(bj.is_empty(c.show_cards_to_users))){b=c.show_cards_to_users.value}var a=null;if(!(bj.is_empty(c.allow_editing_cards_to_users))){a=c.allow_editing_cards_to_users.value}var d=null;if(!(bj.is_empty(c.editor_role))){d=c.editor_role.value}var h=null;if(!(bj.is_empty(c.creator_role))){h=c.creator_role.value}var g={};if(!(bj.is_empty(j.denormalized))){g=j.denormalized}var f={};if(!(bj.is_empty(g[j.proto_key]))){f=g[j.proto_key]}f=bj.merge(f,{show_cards_to_users:b,editor_role:d,allow_editing_cards_to_users:a,creator_role:h});g[j.proto_key]=f;j.denormalized=g}function b7(b,d){if(typeof(d)!=="boolean"){d=false}if(a6()){return true}if(bj.is_empty(b)){if(d){bw.log("no proto found and you are not admin - can't create new card",LOG_LEVEL.warning)}return false}var c=by(b);var e="";if(!(bj.is_empty(c.editor_role))&&typeof(c.editor_role.value)==="string"){e=c.editor_role.value}if(e===""){return true}var f=bU();if(f.indexOf(e)!==-1){return true}var a="";if(!(bj.is_empty(c.creator_role))&&typeof(c.creator_role.value)==="string"){a=c.creator_role.value}if(a===""){if(d){bw.log("you don't have the creator role - can't create new card",LOG_LEVEL.warning)}return false}if(f.indexOf(a)!==-1){return true}if(d){bw.log("all security checks have failed for you - can't create new card",LOG_LEVEL.warning)}return false}function aV(a,g,c,f){if(typeof(c)!=="boolean"){c=true}if(typeof(f)!=="boolean"){f=false}if(!(bj.is_empty(a))&&a.readonly===true){if(c){bw.log("the card is readonly - can't edit",LOG_LEVEL.warning)}return false}if(!(bj.is_empty(a))&&a.persistent===false){if(c){bw.log("card not persistent - you can edit",LOG_LEVEL.warning)}return true}if(a6()){if(c){bw.log("you're admin",LOG_LEVEL.warning)}return true}if(!(bj.is_empty(a))&&a.definition_type==="User"&&a._id===aZ.user_card._id){return true}if(!(bj.is_empty(a))&&a.definition_type==="ApplicationProperties"&&typeof(bJ.application_key)!=="string"){return true}if(bj.is_empty(g)){if(c){bw.log("no proto found, can't edit card",LOG_LEVEL.warning)}return false}if(f===true){if(c){bw.log("new card - checking creation permissions",LOG_LEVEL.warning)}return b7(g,c)}var h=by(g);var e="";if(!(bj.is_empty(h.editor_role))&&typeof(h.editor_role.value)==="string"){e=h.editor_role.value}if(e===""){if(c){bw.log("no editor set - you can edit",LOG_LEVEL.warning)}return true}if(bU().indexOf(e)!==-1){if(c){bw.log("you're editor",LOG_LEVEL.warning)}return true}var b=0;if(!(bj.is_empty(h.allow_editing_cards_to_users))&&typeof(h.allow_editing_cards_to_users.value)==="number"){b=h.allow_editing_cards_to_users.value
}if(b===1){if(c){bw.log("you're not editor and cards with proto "+g._id+" can only edited by editors",LOG_LEVEL.warning)}return false}var d=aZ.user_id;if(typeof(d)!=="string"||d===""){if(c){bw.log("you can't edit the card - no user id found!",LOG_LEVEL.warning)}return false}d=aT(d);if(!(bj.is_empty(a))&&bH(a).indexOf(d)!==-1){if(c){bw.log("you're a related user and you can edit",LOG_LEVEL.warning)}return true}if(c){bw.log("you can't edit the card - all security checks have failed to give you permission",LOG_LEVEL.warning)}return false}function a2(j,g,a,e){if(typeof(a)!=="boolean"){a=true}if(typeof(e)!=="boolean"){e=false}if(a6()){return false}if(j.hidden===true){if(a){bw.log("hidden flag is enabled.",LOG_LEVEL.message)}return true}var d={};if(!(bj.is_empty(g))){d=by(g)}var c=0;if(typeof(j.show_cards_to_users)==="number"){c=j.show_cards_to_users}if(c===0&&!(bj.is_empty(d.show_cards_to_users))&&typeof(d.show_cards_to_users.value)==="number"){c=d.show_cards_to_users.value}var h="";if(typeof(j.editor_role)==="string"){h=j.editor_role}if(h===""&&!(bj.is_empty(d.editor_role))&&typeof(d.editor_role.value)==="string"){h=d.editor_role.value}switch(c){case 1:if(e){return false}var b=aZ.user_id;if(typeof(b)==="string"&&b!==""){b=aT(b);if(bH(j).indexOf(b)!==-1){return false}}case 2:var f=h!==""&&bU().indexOf(h)===-1;if(f&&a){bw.log("hidden since your roles do not match the designated editor role. editor role key: "+h+", the proto key is "+g._id,LOG_LEVEL.message)}return f;case 4:if(e){return false}if(a){bw.log("this Card is only visible to Administrators",LOG_LEVEL.message)}return true}return false}function bB(a){if(a.hidden===true){return true}if(a.show_to_users===4&&!(a6())){return true}}function cf(a){var b="";if(Array.isArray(a)){b=a.join()}else{b=String(a)}return b}function a1(k,n,r,m){var g=["Text","Number"];if(n){g.push("MultilanguageText");g.push("Relation")}var p=[];if(!(bj.is_empty(k.design_elements))){var e=by(k);var c=0;var h=null;for(var q=0;q<k.design_elements.length;q++){var o=i(k.design_elements[q]);h=bj.get_property(o,"display_priority");if(typeof(h)!=="number"||o.deleted===true){h=0}if(h>c){c=h}}var l=-1;while(p.length<r&&k.design_elements.length&&k.design_elements.length>l+1){l++;var d=k.design_elements[l];if(bj.is_empty(d)){bw.log("invalid design element found in related document "+k._id+" at index "+String(l),LOG_LEVEL.warning);continue}var s=i(d);if(s.deleted===true){continue}if(s.cardinality_setting===2||s.multiple_values_setting===1||Array.isArray(s.value)){continue}h=bj.get_property(s,"display_priority");if(typeof(h)!=="number"){h=0}if(h<c){continue}if(bj.get_property(s,"user_enabled_setting")===2){continue}identifier=bu(d);if(typeof(identifier)!=="string"||identifier===""){continue}var j=bj.get_property(s,"element_type");if(typeof(j)!=="string"||g.indexOf(j)===-1){continue}var a=bj.get_property(d,"value");if(bj.is_empty(a)){continue}var b="";if(j==="MultilanguageText"){b=a4(a,"",m)}else{if(j==="Relation"){var f=bI(a,false);if(bj.is_empty(f)){continue}if(f.deleted===true){continue}b=bN(f,false,1,"Parent: ",undefined,m)}else{b=cf(a)}}if(b===""){continue}p.push(b)}}return p}function bY(d,b){var c=by(d);var a="";if(c.shortname!==undefined){a=aP(c.shortname,b)}if(a===""&&c.name!==undefined){a=aP(c.name,b)}if(a===""&&c.plural_name!==undefined){a=aP(c.name,b)}if(a===""&&c.label!==undefined){a=aP(c.label,b)}return a}function bN(j,h,k,b,c,l){function g(){var m=bj.get_property(j.denormalized,j._id);if(typeof(m)==="object"&&m!==null&&typeof(m.shortname)==="object"&&m.shortname!==null){f=cb(m.shortname,function(n){return n},c)[0]}return f}if(bj.is_empty(j)){return""}if(j.definition_type==="ApplicationProperties"){return a4(ML_KEYS.application_properties_key,"application properties",c)}if(j.definition_type==="ImportExportCard"){return a4(ML_KEYS.import_export_title_key,"import export",c)}var f="";if(l!==true){f=g();if(f!==""){return f}}var a=cd(j);if(bj.is_function(a.get_shortname)){f=a.get_shortname(bc(j))}if(f!==""){return f
}if(h===undefined){h=true}if(k===undefined){k=3}if(b===undefined){b="Card: "}f=bY(j,c);if(f===""){var d=a1(j,h,k,c);f=d.join()}if(f===""){f=g();if(f!==""){return f}}if(f===""){var e=null;if(j.proto_key!==undefined){e=bI(j.proto_key)}if(!(bj.is_empty(e))){f=bY(e,c)}}if(typeof(j.definition_type)==="string"&&j.definition_type!==""){if(f===""){f=j.definition_type+":"+j._id}else{f=j.definition_type+":"+f}}if(f===""){f=b+j._id}return f}function bp(b,a){if(a!==true){return b}return a4(ML_KEYS.before_first_save_card_save_prefix)+" "+b}function bP(d,a){if(a===undefined){a=false}var b="";var e=cd(d);if(bj.is_function(e.get_title)){b=e.get_title(bc(d),a)}if(b!==""){return b}var c=bj.get_property(d,"title_multilanguage_key");if(typeof(c)==="string"&&c!==""){return bp(a4(c,"[MultiLanguage Card "+c+" for title not found]"),a)}return bp(bN(d),a)}function ca(f,c,a,d){var e={};if(!(Array.isArray(f))){return e}for(var b=0;b<f.length;b++){if(bj.is_empty(f[b])||f[b]._id===undefined){continue}e[f[b]._id]=bN(f[b])}return e}function aQ(a,b){if(typeof(b)!=="boolean"){b=true}if(typeof(a)!=="object"||a===null||Array.isArray(a)){bw.log("cannot get type of invalid card: "+JSON.stringify(a),LOG_LEVEL.error);return null}if(b&&typeof(a._id)==="string"&&a._id in b5){return aQ(b5[a._id],false)}if(!("definition_type" in a)||a.definition_type==="DynamicCard"){if(!("proto_key" in a)){bw.log("card with id neither contains a definition type nor a proto key - invalid type; card: "+JSON.stringify(a));return null}return"DynamicCard"}card_type=a.definition_type+"Definition";if(!(card_type in bf)){return"DynamicCard"}return card_type}function bF(g,j){var b=aQ(g);if(b==="ProtoDefinition"){var k=by(g);var c=null;if(!(bj.is_empty(k.card_design_elements))){c=k.card_design_elements.value}var h=false;var e=false;if(Array.isArray(c)){for(var d=0;d<c.length;d++){var f=bI(c[d],false);if(typeof(f)!=="object"||f===null){continue}var a=aQ(f);if(a==="TableViewDefinition"){e=true;continue}if(a==="ButtonDefinition"){continue}h=true}}if(h===true){return a4(ML_KEYS.data_proto,"Data Proto",j)}if(e===true){return a4(ML_KEYS.tableview_proto,"Overview Proto",j)}return a4(ML_KEYS.utility_proto,"Utility Proto",j)}return b}function bl(a){var b=[];if(!(Array.isArray(a))){bw.log("cannot heal cards: not in array form",LOG_LEVEL.error)}for(var c=0;c<a.length;c++){b.push(b6(a[c]))}return b}function b6(l,b,o){function n(t,p,q){if(Array.isArray(t.design_elements)&&Array.isArray(p)){var r=by(p);for(var s=0;s<t.design_elements.length;s++){if(t.definition_type==="Log"&&t.design_elements[s].value_type==="unicode"&&typeof(t.design_elements[s].value)==="string"&&t.design_elements[s].value.trim()===""||t.definition_type!=="Log"&&typeof(t.design_elements[s][q])==="string"&&!(t.design_elements[s][q] in r)){t.design_elements[s].hidden=true}}}}if(bj.is_empty(l)||typeof(l)!=="object"){return{}}if(typeof(l._id)!=="string"||l._id===""){l._id=bj.get_uuid()}if(b===undefined){b={}}if(o===undefined){o=bk}bZ(l);var k=aQ(l);if(k===null){bw.log("cannot heal card - type not recognized",LOG_LEVEL.error);return l}if(k==="DynamicCard"&&!("proto_key" in l)&&l._id in b5){l.proto_key=b5[l._id].proto_key}else{if(k!=="DynamicCard"&&!("definition_type" in l)&&l._id in b5){l.definition_type=b5[l._id].definition_type}else{if(k==="DynamicCard"&&"definition_type" in l){l.proto_key=l.definition_type;delete l.definition_type;b.value=true}}}if(typeof(l.last_healed)==="string"&&l.last_healed<STRUCTURE_VERSION){bT.migrate_card(bc(l));b.value=true}var e=l;if(typeof(e.temporary_data)==="object"&&e.temporary_data!==null){delete e.temporary_data}if(typeof(e.denormalized)==="object"&&e.denormalized!==null&&e._id in e.denormalized){delete e.denormalized[e._id]}if(l._id in b5&&(typeof(l.last_healed)!=="string"||l.last_healed<STRUCTURE_VERSION)){var j=b5[l._id];if(j.last_healed<STRUCTURE_VERSION){var a=aQ(j);if(a===null){bw.log("template card with unknown type: "+j._id);a=k}j=bj.extend(bf[a],j);j.last_healed=STRUCTURE_VERSION;b5[l._id]=j}if(j.readonly===true){e=j
}else{n(l,j.design_elements,"name");e=bj.extend(j,l)}e.last_healed=STRUCTURE_VERSION;b.value=true}else{if(typeof(l.last_healed)!=="string"||l.last_healed<STRUCTURE_VERSION){n(l,bf[k].design_elements,"name");e=bj.extend(bf[k],l);e.last_healed=STRUCTURE_VERSION;b.value=true}}if(k!=="DynamicCard"){return e}var f=o[l.proto_key];if(bj.is_empty(f)){bw.log("cannot complete card healing for card "+l._id+": proto not found or invalid ("+l.proto_key+")");return e}bW(e,f);var d=by(f);if(!("card_design_elements" in d)){return e}var c=d.card_design_elements.value;if(!(Array.isArray(c))){bw.log("invalid proto: card_design_elements is not a multivalue field: "+String(d.card_design_elements));return e}var m=[];for(var g=0;g<c.length;g++){var h=bI(c[g]);if(typeof(h)!=="object"||h===null||h.deleted===true){continue}m.push({definition_key:c[g],value:""})}n(e,m,"definition_key");e.design_elements=bj.extend(m,e.design_elements);return e}function b9(j){var b={};switch(j.definition_type){case"RelationField":case"UserRelationField":case"TableView":var c=by(j);var k=j.parent_application_setting;if(typeof(k)!=="string"||k===""){k=j.application_setting}if(typeof(k)!=="string"||k===""){k=bj.get_property(c.parent_application_setting,"value")}if(typeof(k)!=="string"||k===""){k=bj.get_property(c.application_setting,"value")}if(typeof(k)==="string"&&k!==""){b.parent_application_id=k}}var f=bM("&&multilanguageProto");var d=by(f);var h=d.card_design_elements.value;var g={};var a={};for(var e=0;e<h.length;e++){g[h[e]]=bN(j,undefined,undefined,undefined,h[e],true);var l=bF(j,h[e]);if(typeof(l)!=="string"||l===""){bw.log("could not determine type in language "+h[e]+" for card "+JSON.stringify(j));a[h[e]]="n/a"}else{a[h[e]]=bF(j,h[e])}}b.shortname=g;b.displayable_type=a;return b}function bx(h,a){function d(k,n,m){var l=null;if(typeof(m)==="string"&&m!==""){l={parent_application_id:m}}else{var o=bI(k,false);if(bj.is_empty(o)){return}l=b9(o)}if(bj.is_empty(l)){bw.log("no denormalized data could be extracted from card "+k+" in order to update denormalized data for "+n._id);return}if(bj.is_empty(n.denormalized)){n.denormalized={}}n.denormalized[k]=l}if(typeof(h)!=="object"||h===null){bw.log("card has invalid type, cannot update denormalized data: "+String(h),LOG_LEVEL.error);return}if(typeof(a)!=="boolean"){a=false}var f=b9(h);if(bj.is_empty(h.denormalized)){h.denormalized={}}h.denormalized[h._id]=f;if(a===true||aQ(h)!=="DynamicCard"){return}for(var c=0;c<h.design_elements.length;c++){var b=h.design_elements[c];if(typeof(b.definition_key)!=="string"||b.definition_key===""){continue}var e=bI(b.definition_key);if(typeof(e)!=="object"||e===null||e.deleted===true){continue}if(["RelationField","UserRelationField"].indexOf(e.definition_type)===-1){continue}d(b.definition_key,h);relation_field_denormalized_data=bj.get_property(h.denormalized,b.definition_key);var j=null;if(!(bj.is_empty(relation_field_denormalized_data))&&typeof(relation_field_denormalized_data.parent_application_id)==="string"&&relation_field_denormalized_data.parent_application_id!==""&&relation_field_denormalized_data.parent_application_id!==bJ.application_key){j=relation_field_denormalized_data.parent_application_id}if(typeof(b.value)==="string"&&b.value!==""){d(b.value,h,j)}else{if(Array.isArray(b.value)){for(var g=0;g<b.value.length;g++){d(b.value[g],h,j)}}else{if(b.value!==""){bw.log("design element value neither string nor array - cannot denormalize : "+JSON.stringify(b.value))}}}}}function ce(b,g){if(typeof(b)!=="object"||b===null){bw.log("card is of invalid type, cannot update relating cards: "+String(b),LOG_LEVEL.error);return null}if(!(Array.isArray(g))){bw.log("relating cards are not of array type, cannot update denormalization",LOG_LEVEL.error);return null}if(typeof(b.definition_type)==="string"&&b.definition_type.indexOf("Field")!==-1){var h=null;for(var a=0;a<g.length;a++){if(g[a].definition_type==="Proto"){h=g[a];break}}if(h===null){bw.log("cannot update denormalization of proto - proto not found as a relating card when saving field "+b._id)
}var c=by(h);var e=[];if(Array.isArray(c.card_design_elements.value)){e=c.card_design_elements.value}if(e.indexOf(b._id)===-1){e.push(b._id)}}var f=b9(b);var d=[];if(!(bj.is_empty(f))){for(var a=0;a<g.length;a++){if(bj.is_empty(g[a].denormalized)){g[a].denormalized={}}g[a].denormalized[b._id]=f;bx(g[a],true);bA(g[a]);d.push(g[a])}}return d}function bM(b){var a=bI(b);if(a===null){bw.log("proto is missing in this application: "+b,LOG_LEVEL.error);return null}if(a.definition_type!=="Proto"){bw.log("invalid definition type in proto: "+a.definition_type,LOG_LEVEL.error);return null}return a}function aW(b){var c="";var d=Date.parse(b);if(isNaN(d)){bw.log("The following value could not be interpreted as a date: "+b,LOG_LEVEL.message);return c}var a=new Date(d);return a.toISOString()}function b8(j,f){if(typeof(j)!=="object"||j===null){bw.log("card has invalid type, cannot apply posted form: "+String(j),LOG_LEVEL.error);return null}if(typeof(f)!=="object"||f===null){bw.log("posted form has invalid type, cannot apply to card: "+String(f),LOG_LEVEL.error);return j}var a=bj.clone(j);if(!(Array.isArray(j.design_elements))){return a}for(var h=0;h<a.design_elements.length;h++){var g=a.design_elements[h];var e=bu(g);var d=i(g);if((d.multiple_values_setting===1||d.cardinality_setting===2)&&d.value_type!=="key"){bw.log(e+": multiple values setting is only supported with value_type 'key'",LOG_LEVEL.error);continue}var b=null;var c=f[e];if(c===undefined&&(d.multiple_values_setting===1||d.cardinality_setting===2)){b=[];continue}else{if(c===undefined){continue}}if(d.multiple_values_setting===1||d.cardinality_setting===2){if(Array.isArray(c)){b=c}else{if(typeof(c)==="string"&&c!==""){b=c.split(",")}else{if(c===""){b=[]}else{bw.log(e+": unrecognised value format for multivalue key",LOG_LEVEL.error)}}}}else{switch(d.value_type){case"unicode":case"key":b=String(c);break;case"date":b="";if(typeof(c)==="string"&&c!==""){b=aW(c)}break;case"number":if(c===""||c===null){b=null}else{if(isNaN(Number(c))){b=String(c)}else{b=Number(c)}}break;case"boolean":if(c==="Yes"||c===true){b=true}else{b=false}break;default:b=String(c)}}g.value=b}return a}function a3(a){return/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i.test(a)}function aU(b){var a=[];if(!(bj.is_empty(b))&&!(bj.is_empty(b.modification_log))){a=b.modification_log}return a}function bb(b,d){var a="";var e=null;var f=aU(b);var c=f.length;if(c>0){e=f[c-1];a=bj.get_property(e,d);if(bj.is_empty(a)){a=""}}return a}function bR(c,d){var b="";var e=null;var a=aU(c);if(a.length>0){e=a[0];b=bj.get_property(e,d);if(bj.is_empty(b)){b=""}}return b}function bg(a,e){var d=[];for(var c=0;c<a.length;c++){var f=false;for(var b=0;b<e.length;b++){if(a[c]._id===e[b]._id){f=true;break}}if(f===false){d.push(a[c])}}return d}function be(h,N,y,f){function G(P){var Q={};for(var O=0;O<P.length;O++){bx(P[O],true);bA(P[O]);if(P[O].readonly===true&&"user_id" in aZ&&aZ.user_id!=="system_and_support"){continue}Q[P[O]._id]=P[O]}return Q}h=bc(h);if(!("_id" in h)){return G(bV)}var k=b8(h,N);var a=cd(k);if(bj.is_function(a.on_save)){a.on_save(bc(k),y,f)}var s=[];var r=by(h);var K=by(k);if(!(Array.isArray(h.design_elements))){bx(k);s.push(k);return G(s.concat(bg(bV,s)))}for(var e in K){var n=K[e];var D=i(n);var d=bj.get_property(r[e],"value");var m=bj.get_property(K[e],"value");switch(D.element_type){case"MultilanguageText":if((typeof(d)!=="string"||d===""||!(a3(d)||d.indexOf("&&mlkey")!==-1)||d!==m)&&m!==""&&!(a3(m))){var j=a5();var o=bM("&&multilanguageProto");if(o===null){bw.log("could not get multilanguage proto card for this application - aborting multilanguage card save.",LOG_LEVEL.error);continue}var q=by(o);if(!("card_design_elements" in q)||q.card_design_elements.value.indexOf(j)===-1){o=b6(o);q=by(o);q.card_design_elements.value.push(j);bk["&&multilanguageProto"]=o;s.push(o);language_field_definition_card=b6({_id:j,definition_type:"TextField",design_elements:[{name:"grid_size_setting",value:1},{name:"number_of_lines_setting",value:1}]});
bk[j]=language_field_definition_card;s.push(language_field_definition_card)}var E=bj.get_uuid();var x=b6({_id:E,proto_key:"&&multilanguageProto"});var t=by(x);t[j].value=m;bk[E]=x;s.push(x);K[e].value=E}break}}if(k.definition_type==="RelationField"){var F=by(k);var v=0;if(!(bj.is_empty(F.presentation_setting))){v=F.presentation_setting.value}switch(v){case 1:F.cardinality_setting.value=2;F.allow_new_cards.value=false;break;case 2:F.cardinality_setting.value=2;F.allow_new_cards.value=true;break;default:F.cardinality_setting.value=1;F.allow_new_cards.value=false}}else{if(k.definition_type==="ApplicationProperties"){var J=k.get_value("languages");var c=bI("&&multilanguageProto");if(!(bj.is_empty(c))){var l=c.get_value("card_design_elements");var I=false;if(JSON.stringify(J)!==JSON.stringify(l)){I=true}for(var z=0;z<J.length;z++){if(l.indexOf(J[z])===-1){var p={_id:J[z],design_elements:[{name:"grid_size_setting",value:1},{name:"number_of_lines_setting",value:1}]};p.__proto__=bf.TextFieldDefinition;bk[J[z]]=p;s.push(p);I=true}}if(I){if(!(c.set_design_element_value("card_design_elements",J,false))){bw.log("could not add a language - element on multilanguage proto card not found",LOG_LEVEL.error)}else{bk["&&multilanguageProto"]=c;s.push(c)}}}}else{if(k.definition_type==="Proto"&&y===true){var L=K.cards_based_on_this;if(typeof(L)==="object"&&L!==null){L.application_setting=bJ.application_key;L.entity_proto_setting=k._id}else{bw.log("cards tableview not found in proto")}var A=bj.get_property(K.plural_name,"value");if(typeof(A)!=="string"||A===""){A=bj.get_property(K.name,"value")}if(typeof(A)!=="string"||A===""){A=ML_KEYS.new_tableview_key}var g=b6({definition_type:"TableView",design_elements:[{name:"application_setting",value:bJ.application_key},{name:"entity_proto_setting",value:k._id},{name:"label",value:A}]});bk[g._id]=g;s.push(g);var M=bj.get_uuid();var u=b6({_id:M,definition_type:"Proto",design_elements:[{name:"name",value:A},{name:"card_design_elements",value:[g._id]}]});var w=by(u);w.cards_based_on_this.application_setting=bJ.application_key;w.cards_based_on_this.entity_proto_setting=u._id;bk[u._id]=u;s.push(u);var H=K.automatically_created_tableview_proto;H.hidden=false;H.value=M;var C=b6({proto_key:M,automatically_created_for_proto:k._id});bk[C._id]=C;s.push(C);var B=bI("&&userMenuDefinition",false);if(bj.is_empty(B)){B=b6({_id:"&&userMenuDefinition",definition_type:"Menu"});bk[B._id]=B;s.push(B);application_properties=bI("&&applicationProperties");if(bj.is_empty(application_properties)){bw.log("no application properties found in related cards, cannot properly initialize Proto",LOG_LEVEL.error)}else{application_properties_index=by(application_properties);menus=bj.get_property(application_properties_index.menu_definitions,"value");if(!Array.isArray(menus)){bw.log("invalid menus list in application properties, cannot properly initialize Proto",LOG_LEVEL.error)}else{menus.push(B._id);s.push(application_properties)}}}user_menu_definition_index=by(B);entries=bj.get_property(user_menu_definition_index.menu_entries,"value");if(!Array.isArray(entries)){bw.log("invalid menu entry list in user menu definition, cannot properly initialize Proto",LOG_LEVEL.error)}else{entries.push(C._id);s.push(B)}}}}bx(k);s.unshift(k);var b=G(s.concat(bg(bV,s)));return b}function aX(b,a){for(var c=0;c<a.length;c++){var d=bu(a[c]);if(a[c]!==b[d]){return false}if(a[c].value!==b[d].value){return false}}return true}function by(b){if(typeof(b)!=="object"||b===null){return{}}var e=null;var c=null;var f=null;if(!(Array.isArray(b))){c=b;f=bj.get_property(b.temporary_data,"element_index");e=c.design_elements;if(typeof(f)==="object"&&f!==null){return f}}else{e=b}if(!(Array.isArray(e))){return{}}f={};for(var a=0;a<e.length;a++){if(typeof(e[a])!=="object"||e[a]===null||(Array.isArray(e[a]))){continue}var d=bu(e[a]);if(d===null){continue}f[d]=e[a]}if(c!==null&&"temporary_data" in c){c.temporary_data.element_index=f}else{if(c!==null){c.temporary_data={element_index:f}}}return f
}function bu(a){if(typeof(a)!=="object"||a===null){bw.log("cannot get identifier - design element is not an object",LOG_LEVEL.error);return null}if("definition_key" in a){return a.definition_key}if("name" in a){return a.name}bw.log("cannot get identifier - no 'name' or 'definition_key' property in design element",LOG_LEVEL.error);return null}function aS(a){if(typeof(a)!=="object"||a===null){bw.log("cannot get identifier - design element properties is not an object",LOG_LEVEL.error);return null}if("definition_key" in a){return a.definition_key}if("name" in a){return a.name}bw.log("cannot get identifier - no 'name' or 'definition_key' property in properties: "+JSON.stringify(a),LOG_LEVEL.error);return null}function aP(d,a){var c=i(d);if(c.element_type=="MultilanguageText"){return a4(d.value,"",a)}if(c.value_type=="key"){var b=bI(d.value);if(bj.is_empty(b)){return bN(b)}else{return""}}return d.value}function bh(a){var c=i(a);var d=bj.get_property(c,"label");if(typeof(d)!=="string"||d===""){d=bj.get_property(c,"label_multilanguage_key")}var b=a4(d,"");if(b===""){b=bu(a)}return b}function i(d){if(typeof(d)!=="object"||d===null||Array.isArray(d)){bw.log("cannot retrieve properties - invalid design element: "+String(d),LOG_LEVEL.warning);return{}}var g=null;var a=null;if("definition_key" in d){a=d.definition_key;g=bI(a,false)}var e={definition_card:g};if(!(bj.is_empty(g))){if(g.deleted===true){e.deleted=true;return e}for(var c in g){if(c==="_id"||c==="design_elements"||c==="modification_log"){continue}e[c]=g[c]}if(Array.isArray(g.design_elements)){g.design_element_index=by(g);for(var b in g.design_element_index){e[b]=g.design_element_index[b].value}}}for(var f in d){e[f]=d[f]}return e}function a7(a){if(typeof(a)!=="object"||a===null){return[]}return Object.keys(a)}function a8(b,c){var a={key:b,proto_key:c};return b6(a)}function bL(b,c){var a={key:b,definition_type:c};return b6(a)}function bI(b,a,d){if(a===undefined){a=true}var c=bk;if(typeof(d)==="object"&&d!==null){c=d}if(typeof(b)!=="string"||b===""||b==="$$$"){if(a){bw.log("cannot resolve card for invalid key: "+String(b))}return null}else{if(b in c){return bc(c[b])}else{if(b.indexOf("Definition")!==-1&&bf[b]!==undefined){return bc(bj.clone(bf[b]))}else{if("org.couchdb.user:"+b in c){return bc(c["org.couchdb.user:"+b])}else{if(a){bw.log("cannot resolve key from cards given in context: "+String(b))}}}}}return null}function a5(){if(bt!==null){return bt}var b=bI("&&multilanguageProto");if(typeof(b)!=="object"||b===null){bw.log("ML Proto not found, cannot determine active language");bt="en";return bt}var f=b.get_value("card_design_elements");if(!(Array.isArray(f))){bw.log("Invalid ML Proto, cannot determine active language");bt="en";return bt}if(f.length===0){bt="en";return bt}var g=bj.get_property(aZ,"languages");if(!(Array.isArray(g))){bt=f[0];return bt}for(var a=0;a<g.length;a++){if(f.indexOf(g[a])!==-1){bt=g[a];return bt}var d=g[a].split("_");if(d.length<2){continue}for(var c=d.length-1;c>=1;c--){var e=d.slice(0,c).join("_");if(f.indexOf(e)!==-1){bt=e;return bt}}}bt=f[0];return bt}function cb(h,f,o){var l=null;if(typeof(o)==="string"&&o!==""){l=[o]}else{l=bj.get_property(aZ,"languages")}var a="";if(Array.isArray(l)){for(var e=0;e<l.length;e++){if(l[e] in h){a=f(h[l[e]])}if(typeof(a)==="string"&&a!==""){return[a,l[e]]}var n=l[e].split("_");if(n.length<2){continue}for(var k=n.length-1;k>=1;k--){var m=n.slice(0,k).join("_");if(m in h){a=f(h[m])}if(typeof(a)==="string"&&a!==""){return[a,m]}}}}var d=bI("&&multilanguageProto");if(typeof(d)==="object"&&d!==null){var b=d.get_value("card_design_elements");if(Array.isArray(b)){for(var j=0;j<b.length;j++){var g=b[j];if(g in h){a=f(h[g])}if(typeof(a)==="string"&&a!==""){return[a,g]}}}}if("en" in h){a=f(h.en)}if(typeof(a)==="string"&&a!==""){return[a,"en"]}if("en_US" in h){a=f(h.en_US)}if(typeof(a)==="string"&&a!==""){return[a,"en_US"]}var c=Object.keys(h);if(c.length>0){a=f(h[c[0]])}return[a,c[0]]}function aR(f,b){if(typeof(f)!=="boolean"){f=false
}if(!(Array.isArray(b))){b=[]}var d=Object.keys(LANGUAGE_BY_LOCALE);if(!f){return d}var e=[];for(var c=0;c<d.length;c++){var a=d[c].split("_");if(a.length>1&&b.indexOf(a[0])===-1){continue}e.push(d[c])}return e}function bQ(a){var b=bI(a,false);if(b!==null){b.design_element_index=by(b);return cb(b.design_element_index,function(c){return c.value})}return["",null]}function a4(b,a,c){var e="";var d=bI(b,false);if(d!==null){d.design_element_index=by(d);e=cb(d.design_element_index,function(f){return f.value},c)[0]}if(e!==""){return e}if(a!==undefined){return a}else{bw.log("cannot get multilanguage text for key from cards given in context: "+String(b));return"[Missing Multilanguage Text]"}}function cd(b){if(bj.is_empty(b)||b.definition_type==="Proto"){return{}}var c=b.proto_key;var a=null;if(typeof(c)==="string"){a=bI(c)}if(typeof(script_libraries_by_applicable_key)!=="object"){return{}}if(!(bj.is_empty(script_libraries_by_applicable_key[b._id]))){return script_libraries_by_applicable_key[b._id]}if(!(bj.is_empty(a))&&!(bj.is_empty(script_libraries_by_applicable_key[a._id]))){return script_libraries_by_applicable_key[a._id]}return{}}function bG(a){if(Array.isArray(a.value)){return a.value}if(a.value===""){return[]}var b=aS(a);var c="design element "+b+": expected value is an array of "+a.value_type+", but is of simple type "+typeof(a.value);switch(a.value_type){case"boolean":bw.log(c);if(typeof(a.value)==="boolean"){return[a.value]}break;case"number":bw.log(c);if(typeof(a.value)==="number"){return[a.value]}if(typeof(a.value)==="boolean"){return[Number(a.value)]}break;case"unicode":case"date":bw.log(c);if(typeof(a.value)==="string"&&a.value!==""){return[a.value]}if(typeof(a.value)==="number"){return[String(a.value)]}break;case"key":if(typeof(a.value)==="string"&&a.value!==""){return a.value.split(",")}break}return[]}function bX(a){var b=aS(a);var c="design element "+b+": expected value is of type "+a.value_type+", but is of type "+typeof(a.value);switch(a.value_type){case"boolean":if(typeof(a.value)==="boolean"){return a.value}bw.log(c);return false;case"number":if(a.value===null){return""}if(typeof(a.value)==="number"||typeof(a.value)==="string"){return a.value}bw.log(c);if(typeof(a.value)==="boolean"){return Number(a.value)}break;case"unicode":if(typeof(a.value)==="string"){return a.value}bw.log(c);if(typeof(a.value)==="number"){return String(a.value)}break;case"key":case"date":if(typeof(a.value)==="string"){return a.value}if(Array.isArray(a.value)){return a.value[0]}bw.log(c);break;case"attachment":if(typeof(a.value)==="object"&&a.value!==null&&!(Array.isArray(a.value))){return a.value}return{}}return""}function bi(a){if(a.multiple_values_setting===1||a.cardinality_setting===2){return bG(a)}return bX(a)}function bn(b){var a=bj.get_property(b,"definition_type");if(typeof(a)==="string"&&a!==""){return a}if(typeof(b.automatically_created_for_proto)==="string"&&b.automatically_created_for_proto!==""){return b.automatically_created_for_proto}a=bj.get_property(b,"proto_key");if(typeof(a)==="string"&&a!==""){return a}return null}function bC(a,c,f,q){var m={};if(typeof(a)!=="object"||a===null){a={}}var s={};for(var o=0;o<c.length;o++){c[o]=bc(c[o])}for(var p=0;p<c.length;p++){var l=c[p]._id;if(typeof(l)!=="string"||l===""){bw.log("no _id in healed Card. i: "+p+", length: "+c.length+", healed Card: "+JSON.stringify(c[p]));continue}var g=be(c[p],posted_form,q,validation_errors);m=bj.merge(m,g);var t=bI(l,false,m);if(typeof(t)!=="object"||t===null){continue}s=validator.get_validation_errors(t,validation_errors);if(!(bj.is_empty(s))){break}for(var r=0;r<f.length;r++){var n=f[r]._id;var j=bI(n,false,m);if(typeof(j)==="object"&&j!==null){f[r]=j}}var u=ce(t,f);if(Array.isArray(u)){for(var r=0;r<u.length;r++){m[u[r]._id]=u[r]}}}var e=null;var d=[];if(bj.is_empty(s)){e=[];var h=null;for(var b in m){if(b!==c[0]._id&&b!=="org.couchdb.user:"+c[0]._id){e.push(m[b]);d.push(b)}else{h=b}}if(h!==null){e.unshift(m[h]);d.unshift(h)}}else{for(var k in s){a[k]=s[k]
}}return e}var br={cleanup_card_for_storage:bA,template_cards_by_key:b5,related_cards_by_key:bk,get_template_card_keys:b2,get_cards_needing_update:bO,get_family_of_user_creatables:bv,get_design_element_properties_by_name:cc,get_relation_field_ids_associated_to_proto_by_proto_key:bS,get_value_from_last_modification_log_entry:bb,get_value_from_first_modification_log_entry:bR,get_short_representation:bN,get_short_representations_by_key:ca,get_title:bP,get_card_type:aQ,get_displayable_card_type:bF,get_healed_cards:bl,get_healed_card:b6,get_relating_cards_with_updated_denormalized_data:ce,get_user_role_keys:bU,get_attachment_names:a7,is_current_user_admin:a6,are_new_cards_creatable:b7,is_card_editable:aV,is_uuid:a3,is_card_hidden:a2,is_design_element_hidden:bB,get_card_with_posted_form_applied_by_value_type:b8,get_updated_and_new_cards_by_id:be,get_element_index:by,get_design_element_identifier:bu,get_design_element_identifier_from_properties:aS,get_design_element_properties:i,get_design_element_content:aP,get_design_element_label:bh,create_dynamic_card:a8,create_static_card:bL,resolve_key:bI,get_active_language:a5,get_available_locales:aR,get_multilanguage_string_and_language_from_object_indexed_by_language:cb,get_multilanguage_string_and_language:bQ,get_multilanguage_string:a4,get_script_library:cd,get_responded_value_from_design_element_properties:bi,get_definition:bn,get_updated_cards_and_validation_errors:bC,monkey_patch_card:bc};var b4={};var bs=Object.keys(br);for(var bm=0;bm<bs.length;bm++){var b0=br[bs[bm]];if(typeof(bE)==="object"&&bE!==null){b4[bs[bm]]=bE.profile(b0)}else{b4[bs[bm]]=b0}}return b4};var PAGE_WIDTH=12;var DEFAULT_COLUMN_WIDTH=4;var COLORS={1:{name:"gold",color:"#BD8B5C",color_light:"#D9B99C"},2:{name:"silver",color:"#BBBBBB",color_light:"#D6D6D6"},3:{name:"transparent",color:"rgba(0,0,0,0)",color_light:"rgba(0,0,0,0)"},4:{name:"yellow",color:"#FFAB00",color_light:"#FFCE68"},5:{name:"orange",color:"#FF7811",color_light:"#FFAE76"},6:{name:"red",color:"#DD3947",color_light:"#ED8791"},7:{name:"violet",color:"#B341AB",color_light:"#D28CCD"},8:{name:"blue-dark",color:"#3465AB",color_light:"#85A2CF"},9:{name:"blue-light",color:"#66A3A9",color_light:"#A2C8CC"},10:{name:"green-light",color:"#4EBD5F",color_light:"#94D99D"},11:{name:"green-grass",color:"#8FBE2D",color_light:"#BAD981"},12:{name:"green-yellow",color:"#D8BD00",color_light:"#E9D96D"}};function mod_renderer(ae,at,U,O,ao,ax){var R=ax;var aA=ae;var ar=at;var au=U;var ac=ao;var aq=mod_helper(R);var ad=O;var af=mod_card_structure();var Z=mod_design_element_structure();function ap(b){var c=b.split(":");var a=aA;for(var d=0;d<c.length;d++){if(typeof(a)==="string"){break}a=aq.get_property(a,c[d]);if(a===null){break}}if(typeof(a)==="string"){return a}else{ac.log("template "+b+" not defined");return"[template "+b+" not defined]"}}function i(b,k,l,e){if(typeof(k)!=="object"||k===null||Array.isArray(k)){ac.log("invalid definition of choices",LOG_LEVEL.error);return[]}if(l===undefined){l="MultilanguageText"}if(typeof(e)!=="string"){e=""}var a=Object.keys(k);var j=a.sort(function(p,m){var n=k[p].list_priority;var o=k[m].list_priority;if(typeof(n)!=="number"&&typeof(o)==="number"){return 1}if(typeof(o)!=="number"&&typeof(n)==="number"){return -1}if(typeof(n)!=="number"&&typeof(o)!=="number"){if(p>m){return 1}if(p<m){return -1}return 0}if(n<o){return 1}if(n>o){return -1}return 0});var g=[];for(var f=0;f<j.length;f++){choice=k[j[f]];if(typeof(choice)==="object"&&choice!==null&&"element_type" in choice){l=choice.element_type}var h=false;var c=null;if(e!==""&&e in choice){c=choice[e]}else{c=j[f]}if(String(c)===String(b)){h=true}if(h===false&&l==="MultilanguageText"&&choice.hidden===true){continue}var d=null;if(l==="MultilanguageText"){d=ad.get_multilanguage_string(choice.label_multilanguage_key,choice.label_multilanguage_key)}else{if(l==="Text"){d=choice.value}else{d=choice}}g.push({label:d,name:choice.name,value:c,selected:h})}return g}if(typeof(R)==="object"&&R!==null){i=R.profile(i)}function X(a,d){var b={};var e=Object.keys(d);for(var f=0;f<e.length;f++){var c=a[e[f]];if(!(Array.isArray(c))||c.length===0){continue}b[c[0]]=d[e[f]]}return b}if(typeof(R)==="object"&&R!==null){X=R.profile(X)}function aw(f,l,j,r){var o=[];if(l===undefined){l=[]}if(j===undefined){j={}}if(typeof(r)!=="boolean"){r=false}if(!(Array.isArray(l))){ac.log("invalid element type exclusion",LOG_LEVEL.error);return o}if(aq.is_empty(f)){ac.log("invalid card specified for field label extraction",LOG_LEVEL.error);return o}if(aq.is_empty(f.design_elements)){return o}var m=ad.get_element_index(f);var p=aq.get_property(m.card_design_elements,"value");if(!(Array.isArray(p))){return o}for(var s=0;s<p.length;s++){var a=p[s];var d=ad.resolve_key(a);if(aq.is_empty(d)){continue}if(d.deleted===true){continue}var k=ad.get_element_index(d);var h=aq.get_property(k.parent_entity_proto_setting,"value");if(typeof(h)==="string"&&h!==""){j[h]=a}if(r===true){continue}var q=aq.get_property(d,"element_type");if(q===null||l.indexOf(q)!==-1){continue}var n=aq.get_property(k.display_priority,"value");if(typeof(n)!=="number"){n=10}if(n===0){continue}var c=aq.get_property(d,"value_type");var e=aq.get_property(k.label,"value");var g=a;if(typeof(e)==="string"&&e!==""){var b=ad.get_multilanguage_string(e,"");if(b===""){ac.log("cannot retrieve multilanguage string with key "+e+" - multilanguage card is empty or not found in database")}else{g=b}}o.push({identifier:a,label:g,display_priority:n,is_sortable:c!=="key"})}return o}if(typeof(R)==="object"&&R!==null){aw=R.profile(aw)}function T(b,f){if(f===undefined){f=[]}if(!(Array.isArray(f))){ac.log("invalid element type exclusion",LOG_LEVEL.error);
return d}if(aq.is_empty(b)){ac.log("invalid input specified for field label extraction",LOG_LEVEL.error);return d}var m=null;if(Array.isArray(b)){m=b}else{m=[b]}var d=[];var c=[];for(var k=0;k<m.length;k++){card=m[k];if(aq.is_empty(card.design_elements)){return d}if(!(Array.isArray(card.design_elements))){ac.log("invalid design element definition in card",LOG_LEVEL.error);return d}for(var j=0;j<card.design_elements.length;j++){var g=ad.get_design_element_identifier(card.design_elements[j]);if(g===null){continue}var h=ad.get_design_element_properties(card.design_elements[j]);if(h.deleted===true){continue}var l=aq.get_property(h,"element_type");var a=aq.get_property(h,"value_type");if(l===null||f.indexOf(l)!==-1){continue}var e=aq.get_property(h,"display_priority");if(typeof(e)!=="number"){e=10}if(e===0){continue}if(c.indexOf(g)===-1){c.push(g);d.push({identifier:g,label:ad.get_design_element_label(card.design_elements[j]),display_priority:e,is_sortable:a!=="key"})}}}return d}if(typeof(R)==="object"&&R!==null){T=R.profile(T)}function ag(e,b){var f={filename_label:ad.get_multilanguage_string(ML_KEYS.filename,"filename"),size_label:ad.get_multilanguage_string(ML_KEYS.size,"size"),rows:[]};var d=ad.get_attachment_names(e);for(var c=0;c<d.length;c++){var a=current_card._attachments[d[c]];var g={is_last:c===d.length-1,key:d[c],filename:d[c],file_url:b+"/"+d[c],size:(a.length/1000).toFixed(1)+" kB"};f.rows.push(g)}return f}function av(f,b,k,d,t,e,a){if(typeof(b)!=="string"){b=""}if(e===undefined){e={}}if(a===undefined){a={}}if(!(Array.isArray(k))){ac.log("invalid definition of table view content",LOG_LEVEL.error);return{}}var G=null;var E=[];var F=null;if(typeof(f)==="string"&&f.length>0){var B=f.indexOf("Definition");if(B===-1){G=ad.resolve_key(f);if(aq.is_empty(G)){ac.log("Relation proto key is neither an existing proto nor a static definition: "+f,LOG_LEVEL.warning);G=null}}else{if(Object.keys(af).indexOf(f)===-1){ac.log("Relation proto key is neither an existing proto nor a static definition: "+f,LOG_LEVEL.warning)}else{F=f.substring(0,B);E=ad.get_family_of_user_creatables(F)}}}if(typeof(G)!=="object"){ac.log("invalid definition of proto card for table view",LOG_LEVEL.error);return{}}var s={header_cells:[],rows:[]};var n=null;var g=["TableView","Button"];if(!(aq.is_empty(G))){n=aw(G,g,a)}else{if(k.length>0){n=T(k,g)}else{if(E.length>0){n=T(E[0],g)}else{n=[]}}}var q=5;if(e.show_keys_setting!==true){q=0}s.header_cells.push({text:"Card Key",identifier:"#",display_priority:q,use_icon:false,icon_name:"pushpin"});if(e.show_short_name_setting===true){s.header_cells.push({text:"Short Name",identifier:"&&shortname",display_priority:10,use_icon:false,icon_name:"tag"})}if(e.show_card_type===true){s.header_cells.push({text:ad.get_multilanguage_string(ML_KEYS.card_type,"card type"),identifier:"&&type",display_priority:10,is_sortable:false})}for(var v=0;v<n.length;v++){s.header_cells.push({text:n[v].label,identifier:n[v].identifier,display_priority:n[v].display_priority,is_sortable:n[v].is_sortable})}if(e.show_modified_setting===true){s.header_cells.push({text:ad.get_multilanguage_string(ML_KEYS.modified,"modified"),identifier:"&&modified",display_priority:5,is_sortable:true})}if(e.show_modifier_setting===true){s.header_cells.push({text:ad.get_multilanguage_string(ML_KEYS.modifier,"modifier"),identifier:"&&modifier",display_priority:5,is_sortable:false})}if(e.show_created_setting===true){s.header_cells.push({text:ad.get_multilanguage_string(ML_KEYS.created,"created"),identifier:"&&created",display_priority:2,is_sortable:true})}if(e.show_creator_setting===true){s.header_cells.push({text:ad.get_multilanguage_string(ML_KEYS.creator,"creator"),identifier:"&&creator",display_priority:2,is_sortable:false})}if(ad.is_current_user_admin()&&e.element_type==="TableView"){t.push({modal_id:"tableviewImportActionModal_"+d,title:ad.get_multilanguage_string(ML_KEYS.import_modal_title,"Importing Data"),choice_id:"import_attachment_choice",content:aa({name:"new_card_proto_choice",value_type:"unicode",element_type:"Text",value:ad.get_multilanguage_string(ML_KEYS.import_modal_description)},[],undefined,undefined,undefined,true,true)+aa(Object.create(Z.StaticFileChoiceField,{value:{value:card._attachments},name:{value:"import_attachment"}}),[],undefined,undefined,undefined,undefined,true),action_link_id:"confirm_import_modal",action_style:"primary"})
}if(d==="&&usersTableViewDefinition"&&!(au.is_billable)&&au.number_of_active_users>=2){t.push({modal_id:"tableviewAddActionModal_"+d,title:ad.get_multilanguage_string(ML_KEYS.billing_agreement_required,"Billing Agreement Required"),content:aa({name:"billing_agreement_explanation",value_type:"unicode",element_type:"Text",value:ad.get_multilanguage_string(ML_KEYS.billing_agreement_explanation,"This environment already has two free users defined. In order to add more, please open 'Environment Settings' from the Environment Overview page and accept the billing agreement.")},[],undefined,undefined,undefined,true,true),primary_action_disabled:true,cancel_label:"OK"})}if(e.element_type==="TableView"){return s}for(var y=0;y<k.length;y++){if(aq.is_empty(k[y])){ac.log("Invalid related card with index "+String(y),LOG_LEVEL.error);continue}var o=k[y]._id;if(typeof(o)!=="string"||o===""){ac.log("Card with invalid key specified for tableview",LOG_LEVEL.error);continue}if(k[y].deleted===true){continue}var h=ad.get_element_index(k[y]);var z={key:o,cells:[]};z.cells.push({identifier:"#",content:o});var c=ad.get_short_representation(k[y]);if(e.show_short_name_setting===true){z.cells.push({identifier:"&&shortname",content:c})}z.short_representation=c;if(e.show_card_type===true){z.cells.push({identifier:"&&type",content:ad.get_displayable_card_type(k[y])})}z.is_last=y===k.length-1;for(var C=0;C<n.length;C++){var j=n[C].identifier;var D=h[j];var A="";if(!(aq.is_empty(D))){A=aa(D,k[y].design_elements,null,false,null,true,true)}z.cells.push({identifier:j,content:A})}var l=null;if(e.show_modified_setting===true){z.cells.push({identifier:"&&modified",content:aa({value:ad.get_value_from_last_modification_log_entry(k[y],"time"),definition_key:"&&baseDateTimeDefinition"},k[y].design_elements,null,false,null,true,true)})}if(e.show_modifier_setting===true){l=ad.get_value_from_last_modification_log_entry(k[y],"user");z.cells.push({identifier:"&&modifier",content:aa({value:l,value_type:"key",name:"&&modifier",element_type:"Relation"},k[y].design_elements,null,false,null,true,true)})}if(e.show_created_setting===true){z.cells.push({identifier:"&&created",content:aa({value:ad.get_value_from_first_modification_log_entry(k[y],"time"),definition_key:"&&baseDateTimeDefinition"},k[y].design_elements,null,false,null,true,true)})}if(e.show_creator_setting===true){l=ad.get_value_from_first_modification_log_entry(k[y],"user");z.cells.push({identifier:"&&creator",content:aa({value:l,value_type:"key",name:"&&creator",element_type:"Relation"},k[y].design_elements,null,false,null,true,true)})}s.rows.push(z)}var u={};if(e.allow_new_cards===true){for(var v=0;v<E.length;v++){var r=E[v].title_multilanguage_key;F=E[v].definition_type;u[F]=Object.create(Z.StaticMultilanguageTextField,{label_multilanguage_key:{value:r},name:{value:F},list_priority:{value:E[v].list_priority}})}}var m=null;var w="";var p="";var x="";if((aq.is_empty(u)&&aq.is_empty(G))||e.allow_new_cards!==true){m={name:"card_proto_choice",value_type:"key",element_type:"Relation",value:"",parent_entity_proto_setting:f,parent_application_setting:b};w=ad.get_multilanguage_string(ML_KEYS.add_card_modal_description,"Please choose the card you would like to add here.");p=ad.get_multilanguage_string(ML_KEYS.add_card_title,"Adding a Card");x="existing_card"}else{if(Object.keys(u).length>1){m={name:"card_proto_choice",value_type:"key",element_type:"Choice",value:"",choices:u};w=ad.get_multilanguage_string(ML_KEYS.create_card_modal_description,"Please choose the type of definition you would like to create.");p=ad.get_multilanguage_string(ML_KEYS.create_new_definition_title,"Creating New Definition");x="static_card"}else{s.creation_proto_key=Object.keys(u)[0]}}if(m!==null){t.push({modal_id:"tableviewAddActionModal_"+d,title:p,choice_id:"definition_type_choice",choice_type:x,content:aa({name:"new_card_proto_choice",value_type:"unicode",element_type:"Text",value:w},[],undefined,undefined,undefined,true,true)+aa(m,[],undefined,undefined,undefined,undefined,true),action_link_id:"confirm_link_modal_add_card",action_style:"primary"})
}return s}if(typeof(R)==="object"&&R!==null){av=R.profile(av)}function P(){var f=[];var e=ad.resolve_key("&&applicationProperties",false);if(aq.is_empty(e)){return f}var d=ad.get_element_index(e);var b=d.menu_definitions;if(aq.is_empty(b)){ac.log("application properties without menu entries element");return f}var a=b.value;if(!(Array.isArray(a))){ac.log("invalid menu specification in application properties");return f}for(var c=0;c<a.length;c++){if(a[c]==="&&designMenuDefinition"&&au.show_design_menu===false){continue}if(a[c]==="&&adminMenuDefinition"&&au.show_admin_menu===false){continue}f.push(a[c])}return f}if(typeof(R)==="object"&&R!==null){P=R.profile(P)}function am(r){var f=[];for(var d=0;d<r.length;d++){var a=r[d];var j=ad.resolve_key(a,false);if(typeof(j)!=="object"||j===null){continue}if(j.deleted===true){continue}if(aq.is_empty(j)){ac.log("could not render menu "+a+" - empty or not found");continue}var m=ad.get_element_index(j);var l=m.title;var p="Menu";if(!(aq.is_empty(l))){p=ad.get_multilanguage_string(l.value,p)}var o=m.menu_entries;if(aq.is_empty(o)){ac.log("no menu entries specification in menu "+a);continue}var n=o.value;if(!(Array.isArray(n))){ac.log("invalid menu entries specification in menu "+a);continue}var k=[];for(var g=0;g<n.length;g++){if(typeof(n[g])!=="string"||n[g]===""){continue}var h=ad.resolve_key(n[g]);if(h===null){ac.log("cannot resolve menu entry "+n[g]);continue}if(h.deleted===true){continue}if(aq.is_empty(h)){ac.log("could not get card for menu entry "+n[g]);continue}var e=ad.resolve_key(h.proto_key,false);if(ad.is_card_hidden(h,e,false)){continue}var b=null;if(typeof(e)==="object"&&e!==null){b=e.get_value("theme_color")}if(typeof(b)!=="string"||b===""||b==="transparent"){var c=aq.get_property(au,"theme_color");if(typeof(c)==="string"&&c!==""&&c!=="transparent"){b=c}}if(typeof(b)!=="string"||b===""){b="transparent"}var q=ad.get_short_representation(h);k.push({entry_key:n[g],label:q,theme_color:b})}if(k.length===0){continue}f.push({title_available:true,menu_title:p,menu_entries:k,menu_card_id:a})}return f}if(typeof(R)==="object"&&R!==null){am=R.profile(am)}function ab(g,j,d,k,a,e,f,c){if(e===undefined){e=""}if(k===undefined){k=false}if(a===undefined){a=""}if(typeof(f)!=="boolean"){f=true}if(typeof(c)!=="boolean"){c=false}var l={edit_options:g,edit_group_label:j,show_label:d,bootstrap_btn_class:e,edit_options_available:Array.isArray(g)&&g.length>0,edit_option_count_one:g.length===1&&!k,dropup:c};var b=false;for(var h=0;h<l.edit_options.length;h++){if(aq.is_empty(l.edit_options[h].no_update_action)){l.edit_options[h].no_update_action=l.edit_options[h].action}if(!(l.edit_options[h].is_disabled)){b=true}if(f===false&&(typeof(a)!=="string"||a==="")){a=l.edit_options[h].icon}else{a="flash"}if(typeof(l.edit_options[h].character_icon)==="string"&&l.edit_options[h].character_icon!==""){l.edit_options[h].use_character_icon=true}if(typeof(l.edit_options[h].modal_id)==="string"&&l.edit_options[h].modal_id!==""){l.edit_options[h].show_modal=true;l.edit_options[h].client_side=true}}if(b!==true){l.is_disabled=true}l.group_icon_available=typeof(a)==="string"&&a!=="";l.group_icon=a;return Mustache.to_html(ap("others:edit_options"),l)}if(typeof(R)==="object"&&R!==null){ab=R.profile(ab)}function an(d,j,l,c,b,e){if(typeof(j)!=="string"){j=""}if(typeof(c)!=="boolean"){c=false}if(!(Array.isArray(b))){b=[]}var h=[];for(var g=0;g<b.length;g++){var a=ad.get_design_element_label(b[g]);h.push({label:ad.get_multilanguage_string(ML_KEYS.put_to_element_prefix,"put to '")+a+ad.get_multilanguage_string(ML_KEYS.put_to_element_postfix,"'"),action:"put_to_element",no_update_action:"put_to_element",name:d,icon:"pencil",related_key:ad.get_design_element_identifier(b[g])})}if(c===true&&au.selection_mode!="none"){h.push({label:ad.get_multilanguage_string(ML_KEYS.remove_from_tableview,"remove from this here"),action:"remove_from_tableview",no_update_action:"remove_from_tableview",name:d,icon:"pencil"})}var f=null;var k=null;var m=null;
if(j!=="deleted"){f="put_to_trash_selected";k="no_update_and_put_to_trash_selected";m=ad.get_multilanguage_string(ML_KEYS.put_to_trash_label,"put to trash")}else{f="restore_selected";k="no_update_and_restore_selected";m=ad.get_multilanguage_string(ML_KEYS.restore_label,"restore")}if(l&&au.selection_mode!="none"){h.push({label:m,action:f,no_update_action:k,name:d,icon:"trash"})}if(l&&ad.is_current_user_admin()&&au.selection_mode!="none"){h.push({label:ad.get_multilanguage_string(ML_KEYS.update_action,"update"),action:"update_selected_action",no_update_action:"no_update_and_update_selected_action",name:d,icon:"pencil"})}if(!(au.application_key==="_users"&&e==="UserDefinition")){if(au.can_import!==false&&l&&ad.is_current_user_admin()&&!c){h.push({label:ad.get_multilanguage_string(ML_KEYS.import_action,"import"),action:"import_action",no_update_action:"import_action",name:d,icon:"pencil",modal_id:"tableviewImportActionModal_"+d})}}return ab(h,ad.get_multilanguage_string(ML_KEYS.with_selected_label,"With Selected"),true,true,undefined,"btn-sm")}if(typeof(R)==="object"&&R!==null){an=R.profile(an)}function ah(h){var a="";if(au.is_multi_user_client===false){return""}if(aq.is_empty(ar.user_card)){return""}var d=ad.get_element_index(ar.user_card);var e=aq.get_property(d.first_name,"value");var g=aq.get_property(d.last_name,"value");var f=aq.get_property(d.email,"value");var b=aq.get_property(d.assigned_roles,"value");var c=aq.get_property(ar.user_card,"name");if(typeof(e)==="string"){a=(a+e).trim()}if(typeof(g)==="string"){a=(a+" "+g).trim()}if(a===""&&typeof(f)==="string"){a=f.trim()}if(a===""&&typeof(c)==="string"){a=c.trim()}if(a===""){ac.log("Invalid user profile: needs at least a name attribute in context");a="User Profile"}role="";if(b.indexOf("&&systemRole")!==-1){role=ad.get_multilanguage_string(ML_KEYS.environment_administrator,"Environment Administrator")}else{if(Array.isArray(b)&&b.length>0){role_card=ad.resolve_key(b[0],false);if(!(aq.is_empty(role_card))){role=ad.get_short_representation(role_card)}}}if(role===""){role=ad.get_multilanguage_string(ML_KEYS.member,"Member")}return Mustache.to_html(ap("others:user_menu"),{placement_bottom:h,picture_available:false,username:a,logout_caption:"Logout",logout_url:au.logout_url,user_id:aq.get_property(ar,"user_id"),edit_user_profile_caption:ad.get_multilanguage_string(ML_KEYS.edit_user_profile_caption,"Edit my profile"),role:role})}if(typeof(R)==="object"&&R!==null){ah=R.profile(ah)}function aa(m,n,bb,a1,aX,e,F,t,u,a7,bd,aW,y,a4){if(typeof(m)!=="object"||m===null){ac.log("invalid design element specified to render",LOG_LEVEL.error);return""}if(!(Array.isArray(n))){n=[]}if(typeof(bb)!=="string"){bb=""}if(typeof(a1)!=="boolean"){a1=false}if(typeof(aX)!=="number"){aX=DEFAULT_COLUMN_WIDTH}if(typeof(e)!=="boolean"){e=false}if(typeof(F)!=="boolean"){F=false}if(typeof(a7)!=="boolean"){a7=false}if(typeof(aW)!=="object"){aW={}}if(typeof(bd)!=="string"){bd=""}if(t===undefined){t=[]}if(y===undefined){y=[]}if(typeof(u)!=="boolean"){u=true}var G=ad.get_design_element_identifier(m);if(G===null){ac.log("cannot identify design element",LOG_LEVEL.error);return""}var be=ad.get_design_element_properties(m);if(be.hidden===true){return""}var aV="";if(u===true&&F===false){aV=ad.get_design_element_label(m)}var a=null;if(be.element_type==="LanguageChoice"&&be.map_to_multilanguage_proto===true){var r=ad.resolve_key("&&multilanguageProto");a=r.get_value("card_design_elements",[])}else{if(be.element_type==="Code"){a=ad.get_responded_value_from_design_element_properties(be);if(typeof(a)!=="string"||a.trim()===""){a=au.sample_scriptlibrary_source}}else{a=ad.get_responded_value_from_design_element_properties(be)}}var s="";if(be.element_type===undefined&&be.value_type===undefined){switch(typeof(a)){case"number":s="Number";break;case"boolean":s="YesNo";break;default:s="Text"}}else{if(be.element_type===undefined){switch(be.value_type){case"unicode":s="Text";break;case"key":s="Relation";break;case"number":s="Number";
break;case"date":s="DateTime";break;case"boolean":s="YesNo";break;default:s="Text"}}else{s=be.element_type}}var a3=aq.get_property(be,"user_enabled_setting");var B=true;if(e===true||a3===2||(a1===false&&a3===1)||(s==="Attachments"&&au.can_edit_attachments===false)||s==="Button"||s==="SubmitButton"){B=false}var q={name:G,value:a,label:aV,column_width:aX,before_first_save:a1,inline:F,multi_line:aq.get_property(be,"number_of_lines_setting")===1&&F!==true,save_first_hint:ad.get_multilanguage_string(ML_KEYS.save_first_hint,"save this Card first to edit this element"),disable_label:be.disable_label===true,hidden_in_client:aq.get_property(be,"hidden_in_client")===true};var a0=s;var a9=null;var l=null;var J=null;var x=null;var a5=null;if(typeof(a4)==="string"&&a4!==""){a5=a4}else{a5=ad.get_active_language()}switch(s){case"YesNo":q.yes_text=ad.get_multilanguage_string(ML_KEYS.yes,"yes");q.no_text=ad.get_multilanguage_string(ML_KEYS.no,"no");break;case"Link":a0="Text";break;case"Choice":q.choices=i(a,be.choices);break;case"ColorChoice":if(typeof(a)!=="string"||a===""){a="transparent"}q.choices=i(a,COLORS,"Color","name");break;case"ApplicationChoice":a0="Choice";q.choices=i(a,au.application_choices,"ApplicationChoice");break;case"DateTimeLanguageChoice":a0="Choice";au.supported_datetime_languages.browser="Browser Language";if(typeof(a)!=="string"||a===""){a="browser"}q.choices=i(a,au.supported_datetime_languages,"DateTimeLanguage");break;case"DateTime":q.datetime_display_setting=aq.get_property(be,"datetime_display_setting");break;case"MultilanguageText":if(a!==""&&a1===false){if(F!==true){q.edit_options=ab([{label:ad.get_multilanguage_string(ML_KEYS.inline_edit_change_meaning,"edit multilanguage card"),action:"edit_related_card",no_update_action:"no_update_and_edit_related_card",name:G,icon:"pencil"},{label:ad.get_multilanguage_string(ML_KEYS.inline_edit_clear,"clear"),action:"clear",character_icon:"×",client_side:true}],ad.get_multilanguage_string(ML_KEYS.inline_edit_group_label,"edit"));q.edit_options_available=true}if(Array.isArray(a)){ac.log("multilanguage text element cannot be defined using multiple values");q.value=""}else{var a6=ad.get_multilanguage_string_and_language(a);q.value=a6[0];a5=a6[1]}}if(typeof(a5)!=="string"||a5===""){a5=ad.get_active_language()}q.label+=" ("+a5+")";break;case"Attachments":var H=au.current_path;if(typeof(H)!=="string"){H=""}q.add_attachment_label=ad.get_multilanguage_string(ML_KEYS.add_label);q.table_data=ag(a,H+"/%40%40attachments");q.table_controls_in_header=a7===true;if(a7){y.push({classname:"tableview-only-card"})}q.edit_options=ab([{label:ad.get_multilanguage_string(ML_KEYS.remove_from_tableview,"remove from this here"),action:"remove_from_tableview",no_update_action:"remove_from_tableview",name:G,icon:"pencil"}],ad.get_multilanguage_string(ML_KEYS.with_selected_label,"With Selected"),true,true,undefined,"btn-sm");break;case"Relation":var L=aq.get_property(be,"parent_entity_proto_setting");if(typeof(L)==="string"&&L!==""){q.proto_key=L}a9=be.parent_application_setting;if(typeof(a9)==="string"&&a9!==""){q.related_app_id=a9}var I=aq.get_property(be,"cardinality_setting");var z=null;if(I===0){B=false;a0="ParentRelation"}else{if(I===2){var N=[];var g=null;if(Array.isArray(a)){g=a}else{if(a===""){g=[]}else{if(typeof(a)==="string"){g=[a]}else{ac.log("invalid key defined for relation in design element "+G,LOG_LEVEL.error);g=[]}}}if(!a1||bd==="DynamicCard"){for(var aY=0;aY<g.length;aY++){if(typeof(g[aY])!=="string"||g[aY].length===0){continue}z=ad.resolve_key(g[aY],false);if(aq.is_empty(z)){ac.log("cannot display related card "+g[aY]+" in table "+G+": card not found.");continue}if(z.deleted===true){continue}if(aq.is_empty(z)){ac.log("manually ordered relation contains non existing key or key pointing to invalid card: "+g[aY],LOG_LEVEL.warning);continue}N.push(z)}}a0="ManuallyOrderedTableView";if(!a1&&F!==true){var p=aq.get_property(be,"allow_new_cards");if(typeof(p)!=="string"){p=""}l=ad.resolve_key(L,false);
q.table_data=av(L,a9,N,G,t,be);q.table_controls_in_header=a7===true;if(a7){y.push({classname:"tableview-only-card"})}q.edit_options=an(G,undefined,au.readonly!==true&&B,true);q.allow_new_cards=p;q.use_select_column=au.selection_mode!="none"}else{if(!a1){a0="Text";var k=[];for(var aY=0;aY<N.length;aY++){z=N[aY];k.push(ad.get_short_representation(z))}q.value=k.join(",")}}}else{a0="ParentRelation";var c=[];var o="";z=null;if(typeof(a)==="string"&&a!==""){z=ad.resolve_key(a,false)}var ba=ad.resolve_key(L,false);if(F!==true&&typeof(z)==="object"&&z!==null&&!(ad.is_card_hidden(z,ba,false))){c.push({label:ad.get_multilanguage_string(ML_KEYS.inline_edit_related,"edit related card"),action:"edit_related_card",no_update_action:"no_update_and_edit_related_card",name:G,is_disabled:a1,icon:"pencil",related_app_id:a9});o=ad.get_multilanguage_string(ML_KEYS.inline_edit_group_label,"edit")}if(F!==true&&B===true){c.push({label:ad.get_multilanguage_string(ML_KEYS.inline_edit_clear,"clear"),action:"clear",client_side:true,character_icon:"×"});if(!aq.is_empty(ba)&&be.filter_automatically_setting!==false){J={};aw(ba,undefined,J,true);x=X(aW,J);q.filter_column_keys_by_element=JSON.stringify(x)}}if(F!==true){q.edit_options=ab(c,o,undefined,undefined,"pencil",undefined,false)}if(B!==true){if(typeof(z)==="object"&&z!==null){q.relational_info=ad.get_short_representation(z)}else{q.relational_info=a}}var M=aq.get_property(au,"choices_json_url");if(typeof(M)!=="string"){M=""}q.choices_json_url=M;q.relation_resource_available=M!=="";var b="";if(typeof(be.couchdb_viewname)==="string"){b=be.couchdb_viewname}q.couchdb_viewname=b;var D=be.parent_application_element;if(typeof(D)==="string"&&D!==""){q.app_choice_element=D}}}break;case"LanguageChoice":var K=null;if(Array.isArray(a)){K=a}else{if(a===""){K=[]}else{if(typeof(a)==="string"){K=[a]}else{ac.log("invalid values in language choice design element "+G,LOG_LEVEL.error);K=[]}}}a0="ManuallyOrderedTableView";if(!a1&&F!==true){q.allow_new_cards=false;q.disable_click_to_open=true;l=ad.resolve_key(L,false);q.table_data={header_cells:[],rows:[]};q.table_data.header_cells.push({text:ad.get_multilanguage_string(ML_KEYS.locale,"Locale"),identifier:"&&locale",display_priority:10,is_sortable:false});q.table_data.header_cells.push({text:ad.get_multilanguage_string(ML_KEYS.language,"Language"),identifier:"&&language",display_priority:10,is_sortable:false});for(var a2=0;a2<K.length;a2++){var d={key:K[a2],cells:[]};d.cells.push({identifier:"&&locale",content:K[a2]});d.cells.push({identifier:"&&language",content:LANGUAGE_BY_LOCALE[K[a2]]});q.table_data.rows.push(d)}q.table_controls_in_header=a7===true;if(a7){y.push({classname:"tableview-only-card"})}q.edit_options=an(G,undefined,false,true);q.use_select_column=au.selection_mode!="none";var C={};var f=ad.get_available_locales(be.limit_variations_to_selected_languages===true,K);for(var a2=0;a2<f.length;a2++){var bc=LANGUAGE_BY_LOCALE[f[a2]];C[f[a2]]=Object.create(Z.StaticTextField,{value:{value:bc},name:{value:f[a2]}})}choice_element={name:"card_proto_choice",value_type:"key",element_type:"Choice",value:"",choices:C};t.push({modal_id:"tableviewAddActionModal_"+G,title:ad.get_multilanguage_string(ML_KEYS.application_language_choice_dialog_title),choice_id:"language_choice",choice_type:"object_key",content:aa({name:"language_choice_description",value_type:"unicode",element_type:"Text",value:ad.get_multilanguage_string(ML_KEYS.application_language_choice_dialog_description)},[],undefined,undefined,undefined,true,true)+aa(choice_element,[],undefined,undefined,undefined,undefined,true),action_link_id:"confirm_link_modal_add_card",action_style:"primary"})}else{if(!a1){a0="Text";var k=[];for(var a2=0;a2<K;a2++){k.push(LANGUAGE_BY_LOCALE[K[a2]])}q.value=k.join(",")}}break;case"SubmitButton":B=false;break;case"TableView":B=false;a9=be.application_setting;if(typeof(a9)==="string"&&a9!==""){q.related_app_id=a9}var a8=aq.get_property(be,"entity_proto_setting");l=ad.resolve_key(a8,false);if(typeof(a8)==="string"){q.proto_key=a8
}J={};if(!a1){q.table_data=av(a8,a9,[],G,t,be,J)}x=X(aW,J);var w=au.multiindex_column_keys_by_proto_key;if(typeof(w)!=="object"||w===null){w={}}var v=w[a8];if(!(Array.isArray(v))){v=[]}q.filter_column_keys_by_element=JSON.stringify(x);q.column_keys_available_for_multiindex=JSON.stringify(v);q.table_controls_in_header=a7===true;if(a7){y.push({classname:"tableview-only-card"})}q.table_height=a7?"400px":"200px";q.show_first_save_hint_instead=a1===true;q.show_create_button=au.readonly!==true&&ad.are_new_cards_creatable(l);var j=null;if(typeof(be.couchdb_viewname)==="string"&&be.couchdb_viewname!==""){j=au.tableview_json_url_with_viewname+"/"+be.couchdb_viewname}else{j=au.tableview_json_url}if(typeof(a9)==="string"&&a9!==""&&a9!==au.application_key){matches=j.match(/(.*\/)(.*?)(\/%40%40tableview_datasource.*?)/);if(matches===null){ac.log("The tableview url "+j+" for element "+G+" does not follow the standard for foreign apps. Foreign app ID: "+a9);j=""}else{j=matches[1]+a9+matches[3]}}q.tableview_json_url=j;var A=[];var aZ=aW[a8];if(Array.isArray(aZ)&&aZ.length>0){var h=ad.get_element_index(n);for(var aY=0;aY<aZ.length;aY++){if(aZ[aY]===G||aZ[aY]==="#"){continue}A.push(h[aZ[aY]])}}q.edit_options=an(G,be.couchdb_viewname,au.readonly!==true&&ad.is_card_editable(null,l,false),undefined,A,a8);q.use_select_column=au.selection_mode!="none";break}q.language=a5.replace("_","-");if(bb!==""){q.validation_error=[{text:bb}]}var E=aq.get_property(be,"help_text");if(E!==null&&E!==undefined&&E!==""){q.help_text=[{text:ad.get_multilanguage_string(E,"")}]}var bf="editable";if(B===false){bf="readonly"}return Mustache.to_html(ap("elements:"+bf+":"+a0),q)}if(typeof(R)==="object"&&R!==null){aa=R.profile(aa)}function ai(a){return Mustache.to_html(ap("others:card_row"),{content:a})}function al(h,m,a,d,u,p,t,f,l,q,r){if(d===undefined){d=true}if(l===undefined){l=[]}if(typeof(q)!=="boolean"){q=false}if(typeof(r)!=="boolean"){r=false}if(h.length===0){return""}var e=Math.max(Math.floor(PAGE_WIDTH/h.length),DEFAULT_COLUMN_WIDTH);var g="";var j="";for(var s=0;s<h.length;s++){var c=h[s];var k=ad.get_design_element_identifier(c);var n=null;if(q===true){n=k}if(q===true&&!(k in LANGUAGE_BY_LOCALE)){n=null}var b=a[k];var o=ad.get_design_element_properties(c);j+=aa(c,m.design_elements,b,u,e,d,undefined,p,true,r,t,f,l,n)}return j}function V(n,J,aL,v){if(aL===undefined){aL=false}if(J===undefined){J={}}if(v===undefined){v={}}n=ad.monkey_patch_card(n);var c=ad.resolve_key(n.proto_key,false);if(ad.is_card_hidden(n,c,true,aL)){ac.log("Sorry, you don't have access to this Card.",LOG_LEVEL.message);return""}var F=ad.get_script_library(n);if(aq.is_function(F.on_render)){F.on_render(n,aL)}var A=aq.get_property(n,"design_elements");var aM="";var y=[];var E=false;var j=false;var k=ad.get_card_type(n);var H=au.readonly!==true&&ad.is_card_editable(n,c,false,aL);var l="";var B=[];var I=false;if(n.proto_key==="&&multilanguageProto"){I=true}var aJ=false;if(Array.isArray(A)){var N=ad.get_relation_field_ids_associated_to_proto_by_proto_key(n);var o=[];var G=0;var m=null;var z=0;for(var aI=0;aI<A.length;aI++){var x=n.design_elements[aI];m=ad.get_design_element_properties(x);if(ad.is_design_element_hidden(m)){continue}if(m.deleted===true){continue}if(m.hidden_in_client===true){continue}z+=1;if(z>1){break}}if(z===1){aJ=true}for(var aI=0;aI<A.length;aI++){var x=n.design_elements[aI];m=ad.get_design_element_properties(x);if(ad.is_design_element_hidden(m)){continue}if(m.deleted===true){continue}var w=aq.get_property(m,"element_type");var a=aq.get_property(m,"cardinality_setting");var e=aq.get_property(m,"grid_size_setting");var L=ad.get_design_element_identifier(x);var h=J[L];if(w==="TableView"||w==="Relation"&&a===2||e===1||w==="Code"){var d=al(o,n,J,!H,aL,y,k,N,B,I,aJ);if(d!==""){aM+=ai(d)}G=0;o=[];aM+=ai(al([x],n,J,!H,aL,y,k,N,B,I,aJ))}else{o.push(x);if(aq.get_property(m,"hidden_in_client")!==true){G+=DEFAULT_COLUMN_WIDTH}if(G>=PAGE_WIDTH){aM+=ai(al(o,n,J,!H,aL,y,k,N,B,I,aJ));G=0;o=[]}}if(H&&n.persistent!==false&&m.user_enabled_setting!==2&&(aL!==true||m.user_enabled_setting!==1)&&w!=="TableView"&&w!=="Button"){E=true
}}var D=al(o,n,J,!H,aL,y,k,N,undefined,I,aJ);if(D!==""){aM+=ai(D)}if(n.enable_attachments===true||(typeof(c)==="object"&&c!==null&&c.get_value("enable_attachments")===true)){var aK=al([Object.create(Z.StaticAttachmentField,{value:{value:n._attachments},name:{value:"attachments"}})],n,J,!H,aL,y,k,N,B,I,aJ);aM+=ai(aK)}if(aJ){m=ad.get_design_element_properties(A[0]);if(m.element_type==="TableView"||(m.element_type==="Relation"&&m.cardinality_setting===2)){j=true}}var aO=aq.get_property(n,"_id");l=al([{name:"card_id",value_type:"unicode",element_type:"Text",value:aO,label_multilanguage_key:ML_KEYS.card_id}],n,[],true,false,[],undefined,undefined);l+=al([{name:"card_type",value_type:"unicode",element_type:"Text",value:k,label_multilanguage_key:ML_KEYS.card_type}],n,[],true,false,[],undefined,undefined);if(typeof(au.application_key)==="string"&&au.application_key!==""){l+=al([{name:"app_id",value_type:"unicode",element_type:"Text",value:aq.get_property(au,"application_key"),label_multilanguage_key:ML_KEYS.app_id}],n,[],true,false,[],undefined,undefined)}}var g=[];var p=ad.get_definition(n);if(au.allow_design_mode!==false&&(typeof(n.definition_type)!=="string"||n.definition_type==="")){g.push({label:ad.get_multilanguage_string(ML_KEYS.open_proto,"open proto"),action:"edit_related_card",no_update_action:"no_update_and_edit_related_card",icon:"pencil",related_key:p})}if(n.persistent!==false){g.push({label:ad.get_multilanguage_string(ML_KEYS.show_card_properties,"show properties"),action:"show_card_properties",client_side:true,modal_id:"cardPropertiesModal"});y.push({modal_id:"cardPropertiesModal",title:ad.get_multilanguage_string(ML_KEYS.card_properties_title,"Card Properties"),content:l,action_link_id:"card_properties_modal",action_style:"primary"})}if(au.allow_trash_actions!==false&&H&&n.deleted===true&&n.persistent!==false){g.push({label:ad.get_multilanguage_string(ML_KEYS.restore_label,"restore"),action:"restore",no_update_action:"no_update_and_restore",icon:"trash"})}else{if(au.allow_trash_actions!==false&&H&&n.persistent!==false){g.push({label:ad.get_multilanguage_string(ML_KEYS.put_to_trash_label,"put to trash"),action:"put_to_trash",no_update_action:"no_update_and_put_to_trash",icon:"trash"})}}if(typeof(c)==="object"&&c!==null){v.color=c.get_value("theme_color");if(typeof(v.color)!=="string"||v.color===""||v.color==="transparent"){v.color=aq.get_property(au,"theme_color")}}if(au.allow_design_mode!==false&&n.persistent!==false){var u=P();for(var aI=0;aI<u.length;aI++){var b=u[aI];var s=ad.resolve_key(b,false);if(typeof(s)!=="object"||s===null){continue}var M=ad.get_element_index(s);if(b==="&&designMenuDefinition"){var q=M.menu_entries;if(Array.isArray(q.value)&&q.value.indexOf(n._id)!==-1){v.color=null}}if(typeof(s)!=="object"||s===null||s.deleted===true||au.readonly===true||!(ad.is_card_editable(s,undefined,false))){continue}var f=M.title;var r="Menu";if(!(aq.is_empty(f))){r=ad.get_multilanguage_string(f.value,r)}g.push({label:ad.get_multilanguage_string(ML_KEYS.put_into_menu_prefix,"put into menu").trim()+" '"+r+"'",action:"put_to_menu",icon:"pencil",related_key:b})}}var t={additional_form_classes:B,post_save_action:aq.get_property(n,"post_save_action"),proto_key:p,card_key:n._id,parent_card_key:au.parent_card_key,parent_proto_key:au.parent_proto_key,share_button_available:n.hide_share_button!==true,save_label:ad.get_multilanguage_string(ML_KEYS.save_label,"Save"),save_and_close_label:ad.get_multilanguage_string(ML_KEYS.save_and_close_label,"Save and Close"),close_without_saving_label:ad.get_multilanguage_string(ML_KEYS.close_without_saving_label,"Close without Saving"),rows:aM,cancel_label:ad.get_multilanguage_string(ML_KEYS.cancel_label,"Cancel"),action_label:ad.get_multilanguage_string(ML_KEYS.ok_label,"OK"),before_first_save:aL,saveable_content_available:E,card_title:ad.get_title(n,aL),card_actions_available:true,disable_padding:j,deleted:n.deleted===true,deleted_label:ad.get_multilanguage_string(ML_KEYS.deleted_label,"Deleted"),edit_options:ab(g,ad.get_multilanguage_string(ML_KEYS.card_menu_label,"This Card"),true,true,undefined,"btn-xs",undefined,true),modal_dialogs:[{modal_id:"saveChangesModal",title:ad.get_multilanguage_string(ML_KEYS.save_changes_modal_title,"Save Changes?"),content:ad.get_multilanguage_string(ML_KEYS.save_changes_modal_description,"Do you want to save the changes made to this Card?"),action_link_id:"confirm_link_modal",action_style:"primary"},{modal_id:"discardChangesModal",title:ad.get_multilanguage_string(ML_KEYS.discard_changes_modal_title,"Discard Changes?"),content:ad.get_multilanguage_string(ML_KEYS.discard_changes_modal_description,"Are you sure to discard all changes made to this Card?"),action_link_id:"confirm_link_modal_discard",action_style:"danger"}].concat(y)};
var aN=aq.get_property(ar,"navigation_stack");var aP=E;if(Array.isArray(aN)){t.breadcrumbs=[];if(aN.length>1){aP=true}for(var aI=0;aI<aN.length-1;aI++){var C={};C.card_id=aN[aI].id;C.app_id=aN[aI].app_id;var K=ad.resolve_key(C.card_id,false);if(K===null){ac.log("When rendering "+n._id+": could not resolve card "+C.card_id+" at position "+aI+" in navigation stack, app "+C.app_id);continue}C.representation=ad.get_short_representation(K);t.breadcrumbs.push(C)}}t.card_closeable=aP;return Mustache.to_html(ap("others:card"),t)}function az(d){var h={create_application_label:ad.get_multilanguage_string(ML_KEYS.create_application_label,"Create Application"),delete_modal_title:ad.get_multilanguage_string(ML_KEYS.delete_modal_title,"Deleting an Application"),delete_modal_description:ad.get_multilanguage_string(ML_KEYS.delete_modal_description,"Are you sure that you want to delete this application? All design elements and data will be permanently deleted!"),cancel_label:ad.get_multilanguage_string(ML_KEYS.cancel_label,"Cancel"),confirm_label:ad.get_multilanguage_string(ML_KEYS.confirm_label,"Confirm"),applications:[],user_menu:ah(false),show_environment_settings:ad.is_current_user_admin(),show_create_application:ad.is_current_user_admin()||ad.get_user_role_keys().indexOf("&&applicationCreatorRole")!==-1,show_app_delete_button:ad.is_current_user_admin(),environment_settings_label:ad.get_multilanguage_string(ML_KEYS.environment_settings_label,"Environment Properties"),about_protogrid_label:ad.get_multilanguage_string(ML_KEYS.about_protogrid_label,"About Protogrid"),issues_label:ad.get_multilanguage_string(ML_KEYS.issues_label,"Report a Problem"),version:au.version,environment_title:au.environment_title};if(Array.isArray(d)){for(var g=0;g<d.length;g++){var a=d[g];var j=aq.get_property(a,"url");if(j===null||j===undefined||j===""){ac.log("Invalid application bundle or no url specified",LOG_LEVEL.error);continue}var e=aq.get_property(a,"url_name");if(e===null||e===undefined||e===""){ac.log("Invalid application bundle or no url name specified",LOG_LEVEL.error);continue}var b=aq.get_property(a,"logo_url");if(typeof(b)!=="string"||b===""){b="static/icons/protogrid-152.png"}var f=aq.get_property(a,"theme_color");if(typeof(f)!=="string"||f===""){f="transparent"}var c={url:j,name:e,title:aq.get_property(a,"title"),description:aq.get_property(a,"description"),theme_color:f,logo_url:b,open_label:ad.get_multilanguage_string(ML_KEYS.open_label,"Open"),delete_label:ad.get_multilanguage_string(ML_KEYS.delete_label,"Delete")};if(["_users","users","_replicator","replicator","roles"].indexOf(e)!==-1){c.show_app_delete_button=false}h.applications.push(c)}}return Mustache.to_html(ap("others:environment_portal"),h)}function Y(u,s,n,k,e){if(s===undefined){s=true}if(n===undefined){n=false}var m=aq.get_property(au,"script_root");if(typeof(m)!=="string"){m="";ac.log("invalid or no script root set in application context",LOG_LEVEL.error)}var a=aq.get_property(au,"current_path");if(typeof(a)!=="string"){a="";ac.log("invalid or no path set in application context",LOG_LEVEL.error)}var q=aq.get_property(au,"rows_per_ajax_request");if(typeof(q)!=="number"){q=0}var c=aq.get_property(au,"root_denominator");if(typeof(c)!=="string"){c=""}var f=[];if(s===true&&n===false){var j=P();f=am(j)}var r=au.properties;var o="";var p=c+"static/images/logo.png";if(!(aq.is_empty(r))){var g=ad.get_element_index(r);var b=aq.get_property(g.title,"value");var d=aq.get_property(g.name,"value");var l=aq.get_property(g.icon_url,"value");if(typeof(l)==="string"&&l!==""){p=l}o=ad.get_multilanguage_string(b,d)}var h="";if(typeof(e)==="string"&&e!==""){h="color-"+e}var t={theme_class:h,content:u,application_id:aq.get_property(au,"application_key"),create_label:ad.get_multilanguage_string(ML_KEYS.create_label,"Create"),add_label:ad.get_multilanguage_string(ML_KEYS.add_label,"Add"),script_root:m,root_denominator:c,current_path:a,rows_per_ajax_request:q,app_title_available:o!=="",application_title:o,application_logo_url:p,menus:f,menus_available:s===true,show_environment_link:au.is_multi_app_client!==false,user_menu:ah(k),preferred_locale:aq.get_property(ar,"preferred_locale"),app_locale:aq.get_property(ar,"current_language"),datetime_locale:aq.get_property(ar,"datetime_locale")};
return Mustache.to_html(ap("others:base"),t)}function S(s,e){function p(A){if(!(Array.isArray(A["#"]))||A["#"].length===0){ac.log("invalid tableview data entry without key",LOG_LEVEL.error);return null}return A["#"][0]}function o(A){return"<div data-type='key'>"+A+"</div>"}function d(A,C,B){if(B===undefined){B=0}return Mustache.to_html(ap("elements:readonly:DateTime"),{inline:true,value:A,datetime_display_setting:B})}function w(D,C){var B=ad.resolve_key("org.couchdb.user:"+D,false);var A="";if(typeof(B)==="object"&&B!==null){A=ad.get_short_representation(B)}else{A=D}return Mustache.to_html(ap("elements:readonly:ParentRelation"),{inline:true,relational_info:A})}function k(A,B){return Mustache.to_html(ap("elements:readonly:Text"),{inline:true,value:A})}function v(A,D,F,E){var C=D[F];if(typeof(C)===E){return C}if(typeof(A)!=="object"||A===null){return null}var B=ad.get_element_index(A);C=aq.get_property(B[F],"value");if(typeof(C)===E){return C}C=aq.get_property(A,F);if(typeof(C)===E){return C}return null}function m(B){var A=null;if(B.length>1&&typeof(B[1])==="object"&&B[1]!==null&&!(Array.isArray(B[1]))){A=ad.get_multilanguage_string_and_language_from_object_indexed_by_language(B[1],function(C){return C})[0]}return A}function r(C){var B=ad.resolve_key(C,true);var A="";if(B!==null){A=ad.get_short_representation(B)}return A}function n(D,G){var E="";if(!(G in D)){return E}var A=D[G];var F=null;if(Array.isArray(A)&&A.length>0&&Array.isArray(A[0])){for(var B=0;B<A.length;B++){var C=m(A[B]);if(typeof(C)==="string"&&C!==""){if(E!==""){E+=", "}E+=C}}}else{if(Array.isArray(A)){E=m(A);if(typeof(E)!=="string"||E===""){E="";for(var B=0;B<A.length;B++){var H=ad.resolve_key(A[B],false);if(typeof(H)!=="object"||H===null){continue}if(E!==""){E+=", "}E+=r(A[B])}}}else{if(typeof(A)==="string"&&A!==""){E=r(A)}else{if(typeof(A)!=="string"){ac.log("Invalid entry '"+G+"' in tableview data: "+JSON.stringify(D))}}}}return E}function b(G,C,F,B){if(!(C in G)&&(typeof(F)!=="object"||F===null)){var E=ad.resolve_key(p(G),false);if(E===null||E===undefined){return null}var D="";switch(C){case"#":ac.log("tableview data entry without key",LOG_LEVEL.error);break;case"&&shortname":D=ad.get_short_representation(E);break;case"&&modified":D=ad.get_value_from_last_modification_log_entry(E,"time");break;case"&&created":D=ad.get_value_from_first_modification_log_entry(E,"time");break;case"&&modifier":D=ad.get_value_from_last_modification_log_entry(E,"user");break;case"&&creator":D=ad.get_value_from_first_modification_log_entry(E,"user");break;case"&&type":D=ad.get_displayable_card_type(E);break}F={definition_key:C,value:D}}else{if(typeof(F)!=="object"||F===null){F={definition_key:C,value:G[C][0]}}}if(C==="#"){return o(F.value)}if(C==="&&shortname"){if(typeof(F.value)==="object"&&F.value!==null){ml_text=ad.get_multilanguage_string_and_language_from_object_indexed_by_language(F.value,function(H){return H})[0];return k(ml_text,C)}if(typeof(F.value)==="string"){return k(F.value,C)}ac.log("could not render own shortname - invalid data type in tableview data: "+typeof(F.value));return null}if(C==="&&type"){return F.value}if(C==="&&modified"||C==="&&created"){return d(F.value,C)}if(C==="&&modifier"||C==="&&creator"){return w(F.value,C)}if(v(B,F,"deleted","boolean")===true){return null}if(v(B,F,"display_priority","number")===0){return null}var A=v(B,F,"element_type","string");if(typeof(A)!=="string"||A===""||["TableView","Button","Code"].indexOf(A)!==-1){return null}if(A==="Relation"){ml_text=n(G,C);return k(ml_text,C)}if(["Text","Number"].indexOf(A)!==-1){return F.value}if(A==="DateTime"){return d(F.value,C,v(B,F,"datetime_display_setting","number"))}return aa(F,undefined,undefined,undefined,undefined,true,true,undefined,false)}function g(H,G){if(aq.is_empty(H)){ac.log("cannot reconstruct card from tableview data entry: empty entry");return{}}if(aq.is_empty(G)){ac.log("cannot reconstruct card from tableview data entry: no proto");return{}}var C=[];var E=ad.get_element_index(G);
var D=E.card_design_elements.value;for(var F=0;F<D.length;F++){var B="";if(D[F] in H){B=H[D[F]][0]}C.push({definition_key:D[F],value:B})}var I=[];var A={};if("&&creator" in H){A.user=H["&&creator"][0]}if("&&created" in H){A.time=H["&&created"][0]}var J={};if("&&modifier" in H){J.user=H["&&modifier"][0]}if("&&modified" in H){J.time=H["&&modified"][0]}I.push(A);I.push(J);return{_id:H["#"][0],proto_key:G._id,design_elements:C,modification_log:I}}if(typeof(e)!=="string"){e=""}if(!(Array.isArray(s))){ac.log("invalid input to tableview data gathering function",LOG_LEVEL.error);return[]}var q=[];for(var u=0;u<s.length;u++){var l=null;var c=null;if("&&proto_key" in s[u]){c=ad.resolve_key(s[u]["&&proto_key"][0]);l=g(s[u],c)}else{l=ad.resolve_key(p(s[u]));var x=ad.get_card_type(l);l=ad.get_healed_card(l)}if(ad.is_card_hidden(l,c,false)){continue}var z={};var h=ad.get_element_index(l);var f=Object.keys(h);var a=null;for(var t=0;t<f.length;t++){var y=ad.resolve_key(f[t],false);a=b(s[u],f[t],h[f[t]],y);if(typeof(a)!=="string"){continue}z[f[t]]=a}var j=["#","&&shortname","&&modified","&&created","&&modifier","&&creator","&&type"];for(var t=0;t<j.length;t++){a=b(s[u],j[t]);if(typeof(a)!=="string"){continue}z[j[t]]=a}if(au.selection_mode!="none"){z["&&select"]="<input type='checkbox' class='no-click-to-open selected-single' name='selected_"+e+"' value='"+l._id+"'>"}q.push(z)}return q}var W={render_card:V,render_page:Y,render_environment_portal:az,get_rendered_tableview_data:S};var aj={};var ay=Object.keys(W);for(var Q=0;Q<ay.length;Q++){var ak=W[ay[Q]];if(typeof(R)==="object"&&R!==null){aj[ay[Q]]=R.profile(ak)}else{aj[ay[Q]]=ak}}return aj};